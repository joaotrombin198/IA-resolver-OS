{"file_contents":{"COMO_USAR_VSCODE.md":{"content":"# üéØ Como Usar no VSCode - Guia Completo\n\n## üì• DOWNLOAD E CONFIGURA√á√ÉO\n\n### 1. Baixar o Projeto\n1. **Baixe TODOS os arquivos** desta pasta para seu computador\n2. **Crie uma pasta** (ex: `C:\\OS-Assistant` ou `~/OS-Assistant`)\n3. **Copie todos os arquivos** para essa pasta\n\n### 2. Estrutura Necess√°ria\nSua pasta deve ter exatamente estes arquivos:\n\n```\nOS-Assistant/\n‚îú‚îÄ‚îÄ üìã DOCUMENTA√á√ÉO\n‚îÇ   ‚îú‚îÄ‚îÄ README.md                    ‚Üê Leia primeiro\n‚îÇ   ‚îú‚îÄ‚îÄ INSTALACAO_VSCODE.md        ‚Üê Guia passo a passo\n‚îÇ   ‚îú‚îÄ‚îÄ setup_local.md              ‚Üê Instala√ß√£o detalhada\n‚îÇ   ‚îî‚îÄ‚îÄ DOCUMENTACAO_SISTEMA.md     ‚Üê Manual t√©cnico\n‚îÇ\n‚îú‚îÄ‚îÄ üöÄ EXECU√á√ÉO\n‚îÇ   ‚îú‚îÄ‚îÄ run_local.py                ‚Üê PRINCIPAL - Execute este arquivo\n‚îÇ   ‚îú‚îÄ‚îÄ main.py                     ‚Üê Alternativo\n‚îÇ   ‚îî‚îÄ‚îÄ requirements_local.txt      ‚Üê Lista de depend√™ncias\n‚îÇ\n‚îú‚îÄ‚îÄ üîß CORE DO SISTEMA\n‚îÇ   ‚îú‚îÄ‚îÄ app.py                      ‚Üê Configura√ß√£o Flask\n‚îÇ   ‚îú‚îÄ‚îÄ routes.py                   ‚Üê Todas as p√°ginas/rotas\n‚îÇ   ‚îú‚îÄ‚îÄ models.py                   ‚Üê Estrutura do banco\n‚îÇ   ‚îú‚îÄ‚îÄ case_service.py             ‚Üê Gerenciamento de casos\n‚îÇ   ‚îú‚îÄ‚îÄ ml_service.py               ‚Üê Intelig√™ncia artificial\n‚îÇ   ‚îî‚îÄ‚îÄ file_processor.py           ‚Üê Importa√ß√£o Excel\n‚îÇ\n‚îú‚îÄ‚îÄ üé® INTERFACE\n‚îÇ   ‚îú‚îÄ‚îÄ static/\n‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ style.css               ‚Üê Estilos visuais\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ script.js               ‚Üê Intera√ß√µes\n‚îÇ   ‚îî‚îÄ‚îÄ templates/                  ‚Üê P√°ginas HTML\n‚îÇ       ‚îú‚îÄ‚îÄ base.html\n‚îÇ       ‚îú‚îÄ‚îÄ index.html\n‚îÇ       ‚îú‚îÄ‚îÄ dashboard.html\n‚îÇ       ‚îî‚îÄ‚îÄ ... (outras p√°ginas)\n‚îÇ\n‚îú‚îÄ‚îÄ ‚öôÔ∏è VSCODE (Configura√ß√µes)\n‚îÇ   ‚îî‚îÄ‚îÄ .vscode/\n‚îÇ       ‚îú‚îÄ‚îÄ settings.json           ‚Üê Configura√ß√µes do editor\n‚îÇ       ‚îú‚îÄ‚îÄ launch.json             ‚Üê Debug do sistema\n‚îÇ       ‚îî‚îÄ‚îÄ tasks.json              ‚Üê Comandos r√°pidos\n‚îÇ\n‚îî‚îÄ‚îÄ ü§ñ ML MODELS (Criados automaticamente)\n    ‚îî‚îÄ‚îÄ ml_models/                  ‚Üê Modelos de IA (vazio no in√≠cio)\n```\n\n---\n\n## ‚ö° INSTALA√á√ÉO SUPER R√ÅPIDA\n\n### Passo 1: Instalar Python\n- **Windows:** https://python.org/downloads (marque \"Add to PATH\")\n- **Mac:** `brew install python3`\n- **Linux:** `sudo apt install python3 python3-pip`\n\n### Passo 2: Instalar VSCode\n- Baixe em: https://code.visualstudio.com/\n\n### Passo 3: Configurar Projeto\n1. **Abra VSCode**\n2. **File ‚Üí Open Folder** ‚Üí Selecione pasta `OS-Assistant`\n3. **Abra Terminal** (Ctrl+` ou Terminal ‚Üí New Terminal)\n4. **Execute:**\n\n```bash\n# Instalar depend√™ncias\npip install -r requirements_local.txt\n\n# OU instalar manualmente:\npip install flask flask-sqlalchemy pandas openpyxl scikit-learn werkzeug numpy PyPDF2 email-validator\n\n# Executar sistema\npython run_local.py\n```\n\n### Passo 4: Acessar Sistema\n- **URL:** http://localhost:5000\n- **Deve aparecer:** Tela inicial do OS Assistant\n\n---\n\n## üéÆ COMANDOS DO VSCODE\n\n### Executar Sistema\n- **Desenvolvimento (1 usu√°rio):** `python run_local.py`\n- **Produ√ß√£o (multi-usu√°rio):** `python run_production.py`\n- **Via VSCode Tasks:** Ctrl+Shift+P ‚Üí \"Tasks: Run Task\" ‚Üí \"Executar OS Assistant\"\n- **Debug mode:** F5\n\n### Comandos √öteis via Terminal\n```bash\n# Executar sistema\npython run_local.py\n\n# Instalar depend√™ncias\npip install -r requirements_local.txt\n\n# Verificar casos no banco\npython -c \"from app import *; with app.app_context(): print(f'Casos: {Case.query.count()}')\"\n\n# Backup do banco\ncp os_assistant.db backup_$(date +%Y%m%d).db\n```\n\n### Tasks Autom√°ticas (Ctrl+Shift+P ‚Üí Tasks)\n- **\"Executar OS Assistant\"** - Inicia o sistema\n- **\"Instalar Depend√™ncias\"** - Instala todas as bibliotecas\n- **\"Verificar Status do Banco\"** - Mostra estat√≠sticas\n\n---\n\n## üîß CONFIGURA√á√ïES DO VSCODE\n\n### Extens√µes Recomendadas\n1. **Python** (Microsoft) - Essencial\n2. **Python Debugger** - Para debug\n3. **Pylance** - IntelliSense avan√ßado\n\n### Configura√ß√µes Inclu√≠das\n- **Auto-complete** para Python ativado\n- **Debug** configurado para Flask\n- **Formata√ß√£o** autom√°tica\n- **Syntax highlighting** para templates\n\n---\n\n## üìä USANDO O SISTEMA\n\n### 1. Primeira Execu√ß√£o\n1. Execute `python run_local.py`\n2. Aguarde mensagem \"Banco de dados SQLite inicializado\"\n3. Acesse http://localhost:5000\n4. Voc√™ ver√°: \"0 casos existentes\"\n\n### 2. Importar Seus Dados\n1. **Prepare planilha Excel** com colunas:\n   - **Problema**: Descri√ß√£o do problema\n   - **Solu√ß√£o**: Como foi resolvido  \n   - **Sistema**: Tipo de sistema (Tasy, SGU, etc)\n\n2. **No sistema:**\n   - Menu ‚Üí \"Upload de Casos\"\n   - Selecione sua planilha .xlsx\n   - Clique \"Importar\"\n   - Aguarde confirma√ß√£o\n\n### 3. Funcionalidades Principais\n- **üìä Dashboard**: Estat√≠sticas e casos recentes\n- **‚ûï Adicionar Caso**: Inserir problema manualmente\n- **üîç Analisar Problema**: IA sugere solu√ß√µes\n- **üìã Gerenciar Casos**: Ver, editar, deletar casos\n- **üìÅ Upload de Casos**: Importa√ß√£o em massa\n\n---\n\n## üö® SOLU√á√ÉO DE PROBLEMAS\n\n### Erro: \"python: command not found\"\n```bash\n# Windows - use:\npy run_local.py\n\n# Mac/Linux - use:\npython3 run_local.py\n```\n\n### Erro: \"ModuleNotFoundError\"\n```bash\npip install --upgrade pip\npip install -r requirements_local.txt\n```\n\n### Erro: \"Port 5000 in use\"\n**Edite `run_local.py`** linha final:\n```python\napp.run(port=8080)  # Mude de 5000 para 8080\n```\n\n### Sistema Lento\n- **Feche outros programas** pesados\n- **Use SSD** se poss√≠vel\n- **M√°ximo 10.000 casos** recomendado\n\n### Importa√ß√£o Falha\n- **Verifique colunas:** Exatamente \"Problema\", \"Solu√ß√£o\", \"Sistema\"\n- **Formato:** Arquivo .xlsx (Excel), n√£o .xls\n- **Tamanho:** M√°ximo 5MB por arquivo\n\n---\n\n## üíæ BACKUP E MANUTEN√á√ÉO\n\n### Backup Simples\n```bash\n# Copiar banco de dados\ncp os_assistant.db backup/\n\n# Copiar modelos treinados\ncp -r ml_models/ backup/\n```\n\n### Limpeza\n```bash\n# Resetar banco (CUIDADO!)\nrm os_assistant.db\n\n# Limpar modelos (sistema vai retreinar)\nrm -rf ml_models/\n```\n\n### Atualiza√ß√£o\n1. **Baixe nova vers√£o** dos arquivos\n2. **Mantenha** seu `os_assistant.db`\n3. **Mantenha** pasta `ml_models/`\n4. **Substitua** outros arquivos\n\n---\n\n## üìà PERFORMANCE\n\n### Configura√ß√£o M√≠nima\n- **Python 3.8+**\n- **2GB RAM**\n- **100MB espa√ßo livre**\n- **Windows 10/Mac 10.15/Ubuntu 18.04+**\n\n### Configura√ß√£o Recomendada\n- **Python 3.11+**\n- **4GB RAM**\n- **1GB espa√ßo livre**\n- **SSD**\n\n### Limites Sugeridos\n- **Casos:** At√© 10.000 funcionam bem\n- **Importa√ß√£o:** At√© 1.000 casos por vez\n- **Arquivo:** M√°ximo 5MB por planilha\n\n---\n\n## üìû SUPORTE\n\n### Documenta√ß√£o\n- **README.md** - Vis√£o geral e comandos\n- **INSTALACAO_VSCODE.md** - Passo a passo detalhado\n- **DOCUMENTACAO_SISTEMA.md** - Manual t√©cnico completo\n\n### Debug\n- **Logs:** Aparecem no terminal do VSCode\n- **Erros:** Copie mensagem completa para an√°lise\n- **SQL Debug:** Edite `app.py`, mude `echo: False` para `True`\n\n### Arquivos Importantes\n- **Dados:** `os_assistant.db`\n- **Config:** `.vscode/` (configura√ß√µes VSCode)\n- **Modelos:** `ml_models/` (IA treinada)\n\n---\n\n## üåê ACESSO MULTI-USU√ÅRIO\n\n### Compartilhar na Rede Local\n1. **Execute:** `python run_production.py` (para m√∫ltiplos usu√°rios)\n2. **Descubra seu IP:**\n   ```bash\n   # Windows\n   ipconfig\n   \n   # Mac/Linux  \n   ifconfig\n   ```\n3. **Compartilhe o link:** `http://SEU_IP:5000`\n4. **Exemplo:** `http://192.168.1.100:5000`\n\n### Sincroniza√ß√£o Autom√°tica\n- ‚úÖ **Todos acessam o mesmo banco** SQLite\n- ‚úÖ **Casos adicionados aparecem para todos** instantaneamente\n- ‚úÖ **Importa√ß√µes Excel** ficam dispon√≠veis para toda equipe\n- ‚úÖ **Modelos ML** retreinam automaticamente\n\n### Backup Centralizado\n```bash\n# Fazer backup do banco compartilhado\ncp os_assistant.db backup_$(date +%Y%m%d_%H%M).db\n\n# Restaurar backup\ncp backup_20250814_1030.db os_assistant.db\n```\n\n---\n\n## ‚úÖ CHECKLIST FINAL\n\n**Antes de come√ßar:**\n- [ ] Python instalado e funcionando\n- [ ] VSCode instalado\n- [ ] Pasta do projeto criada\n- [ ] Todos os arquivos copiados\n\n**Configura√ß√£o:**\n- [ ] VSCode aberto na pasta correta\n- [ ] Terminal integrado funcionando\n- [ ] Depend√™ncias instaladas sem erro\n\n**Teste:**\n- [ ] `python run_local.py` executa\n- [ ] http://localhost:5000 carrega\n- [ ] Dashboard mostra \"0 casos\"\n- [ ] Upload de teste funciona\n\n**üéâ PRONTO! Seu OS Assistant est√° rodando perfeitamente no VSCode!**","size_bytes":8448},"DOCUMENTACAO_SISTEMA.md":{"content":"# OS Assistant - Documenta√ß√£o Completa do Sistema\n\n## Vis√£o Geral\n\nO OS Assistant √© um sistema de suporte t√©cnico baseado em machine learning, projetado para diagnosticar e resolver problemas em m√∫ltiplos sistemas (especialmente sistemas hospitalares brasileiros como Tasy, SGU, SGU Card e Autorizador). O sistema funciona como um \"mentor digital\" que analisa descri√ß√µes de problemas e sugere solu√ß√µes baseadas em casos hist√≥ricos.\n\n## Arquitetura do Sistema\n\n### Estrutura de Diret√≥rios\n\n```\nOS-Assistant/\n‚îú‚îÄ‚îÄ app.py                 # Configura√ß√£o principal do Flask\n‚îú‚îÄ‚îÄ main.py                # Ponto de entrada da aplica√ß√£o\n‚îú‚îÄ‚îÄ models.py              # Modelos de dados (SQLAlchemy)\n‚îú‚îÄ‚îÄ routes.py              # Rotas e endpoints da aplica√ß√£o\n‚îú‚îÄ‚îÄ case_service.py        # Servi√ßo para gerenciamento de casos\n‚îú‚îÄ‚îÄ ml_service.py          # Servi√ßo de machine learning\n‚îú‚îÄ‚îÄ file_processor.py      # Processamento de arquivos de importa√ß√£o\n‚îú‚îÄ‚îÄ static/                # Arquivos est√°ticos (CSS, JS)\n‚îÇ   ‚îú‚îÄ‚îÄ style.css\n‚îÇ   ‚îî‚îÄ‚îÄ script.js\n‚îú‚îÄ‚îÄ templates/             # Templates HTML (Jinja2)\n‚îÇ   ‚îú‚îÄ‚îÄ base.html\n‚îÇ   ‚îú‚îÄ‚îÄ index.html\n‚îÇ   ‚îú‚îÄ‚îÄ dashboard.html\n‚îÇ   ‚îú‚îÄ‚îÄ add_case.html\n‚îÇ   ‚îî‚îÄ‚îÄ ...\n‚îú‚îÄ‚îÄ ml_models/             # Modelos de ML treinados (pickle)\n‚îÇ   ‚îú‚îÄ‚îÄ system_classifier.pkl\n‚îÇ   ‚îú‚îÄ‚îÄ label_encoder.pkl\n‚îÇ   ‚îî‚îÄ‚îÄ metadata.pkl\n‚îî‚îÄ‚îÄ attached_assets/       # Arquivos anexados pelos usu√°rios\n```\n\n### Tecnologias Utilizadas\n\n**Backend:**\n- **Flask**: Framework web principal\n- **PostgreSQL**: Banco de dados principal para persist√™ncia\n- **SQLAlchemy**: ORM para intera√ß√£o com banco de dados\n- **Scikit-learn**: Machine learning e processamento de texto\n- **Pandas**: Manipula√ß√£o de dados e importa√ß√£o de planilhas\n- **Gunicorn**: Servidor WSGI para produ√ß√£o\n\n**Frontend:**\n- **Bootstrap**: Framework CSS responsivo com tema escuro\n- **Feather Icons**: Biblioteca de √≠cones\n- **JavaScript**: Funcionalidades interativas (valida√ß√£o, busca, confirma√ß√µes)\n\n**Machine Learning:**\n- **TF-IDF Vectorization**: An√°lise de similaridade de texto\n- **Support Vector Machine (SVM)**: Classifica√ß√£o de tipos de sistema\n- **Naive Bayes**: Classifica√ß√£o complementar\n- **Cosine Similarity**: Busca de casos similares\n\n## Banco de Dados\n\n### Localiza√ß√£o e Configura√ß√£o\n\nO sistema utiliza **PostgreSQL** como banco de dados principal, configurado automaticamente no ambiente Replit:\n\n**Vari√°veis de Ambiente:**\n- `DATABASE_URL`: URL completa de conex√£o\n- `PGHOST`: Host do banco de dados\n- `PGPORT`: Porta (padr√£o: 5432)\n- `PGUSER`: Usu√°rio do banco\n- `PGPASSWORD`: Senha do banco\n- `PGDATABASE`: Nome do banco de dados\n\n### Estrutura das Tabelas\n\n#### Tabela `cases`\n```sql\nCREATE TABLE cases (\n    id SERIAL PRIMARY KEY,\n    problem_description TEXT NOT NULL,\n    solution TEXT NOT NULL,\n    system_type VARCHAR(100) DEFAULT 'Unknown',\n    created_at TIMESTAMP DEFAULT NOW(),\n    effectiveness_score FLOAT,\n    feedback_count INTEGER DEFAULT 0,\n    tags VARCHAR(500) DEFAULT ''\n);\n```\n\n#### Tabela `case_feedbacks`\n```sql\nCREATE TABLE case_feedbacks (\n    id SERIAL PRIMARY KEY,\n    case_id INTEGER REFERENCES cases(id),\n    effectiveness_score INTEGER NOT NULL,\n    resolution_method VARCHAR(50) DEFAULT '',\n    custom_solution TEXT DEFAULT '',\n    created_at TIMESTAMP DEFAULT NOW()\n);\n```\n\n### Backup de Dados\n\nO sistema mant√©m dois n√≠veis de armazenamento:\n1. **Principal**: PostgreSQL para persist√™ncia completa\n2. **Fallback**: Armazenamento em mem√≥ria (tempor√°rio) em caso de falha do banco\n\n## Funcionalidades Principais\n\n### 1. An√°lise de Problemas\n- Entrada de descri√ß√£o de problema via interface web\n- An√°lise autom√°tica usando ML para detectar tipo de sistema\n- Gera√ß√£o de sugest√µes de solu√ß√£o baseadas em padr√µes hist√≥ricos\n- Busca de casos similares usando TF-IDF e similaridade coseno\n\n### 2. Gerenciamento de Casos (CRUD Completo)\n- **Criar**: Adi√ß√£o de novos casos via formul√°rio ou importa√ß√£o\n- **Ler**: Visualiza√ß√£o de casos individuais e listagem completa\n- **Atualizar**: Edi√ß√£o de casos existentes\n- **Deletar**: Remo√ß√£o de casos com confirma√ß√£o\n\n### 3. Importa√ß√£o de Dados\nSuporte para m√∫ltiplos formatos:\n- **Excel (.xlsx, .xls)**: Formato preferido\n- **CSV**: Dados tabulares\n- **TXT**: Texto estruturado\n- **PDF**: Extra√ß√£o de texto (quando PyPDF2 dispon√≠vel)\n\n#### Formato de Importa√ß√£o Esperado\nPara arquivos Excel/CSV, as colunas devem ser nomeadas (case-insensitive):\n- **Problema/Problem**: Descri√ß√£o detalhada do problema\n- **Solu√ß√£o/Solution**: Solu√ß√£o aplicada\n- **Sistema/System**: Tipo de sistema afetado\n\n### 4. Machine Learning Interno\n- **100% Offline**: Sem depend√™ncias de APIs externas\n- **Classifica√ß√£o Autom√°tica**: Detec√ß√£o de tipo de sistema\n- **Aprendizado Cont√≠nuo**: Modelos se adaptam com novos casos\n- **Feedback Loop**: Melhoria baseada em efetividade reportada\n\n### 5. Dashboard e Estat√≠sticas\n- Total de casos por sistema\n- Efetividade m√©dia das solu√ß√µes\n- Casos recentes e tend√™ncias\n- Estat√≠sticas de feedback dos usu√°rios\n\n## Como Usar o Sistema\n\n### 1. An√°lise de Problema\n1. Acesse a p√°gina principal\n2. Digite a descri√ß√£o detalhada do problema\n3. Clique em \"Analisar Problema\"\n4. Revise as sugest√µes e casos similares\n5. Aplique a solu√ß√£o e forne√ßa feedback\n\n### 2. Adicionar Novo Caso\n1. Navegue para \"Adicionar Caso\"\n2. Preencha problema, solu√ß√£o e tipo de sistema\n3. Adicione tags relevantes (opcional)\n4. Salve o caso\n\n### 3. Importar Casos em Lote\n1. Prepare arquivo Excel com colunas: Problema, Solu√ß√£o, Sistema\n2. Acesse \"Upload de Casos\"\n3. Selecione o arquivo\n4. Escolha \"Formato Estruturado\"\n5. Confirme a importa√ß√£o\n\n### 4. Gerenciar Casos Existentes\n1. Acesse \"Dashboard\" para vis√£o geral\n2. Use \"Casos\" para listar todos\n3. Clique em qualquer caso para visualizar/editar\n4. Use a busca integrada para encontrar casos espec√≠ficos\n\n## Seguran√ßa e Privacidade\n\n### Caracter√≠sticas de Seguran√ßa\n- **Sem Conex√µes Externas**: Sistema 100% interno, sem envio de dados para APIs externas\n- **Valida√ß√£o de Entrada**: Sanitiza√ß√£o de todos os inputs do usu√°rio\n- **Sess√µes Seguras**: Gerenciamento de sess√£o com chaves secretas\n- **Separa√ß√£o Cliente/Servidor**: Arquitetura segura com valida√ß√£o no backend\n\n### Dados Sens√≠veis\n- Todos os casos permanecem no banco de dados local\n- Nenhuma informa√ß√£o √© enviada para servi√ßos externos de IA\n- Machine learning executado completamente on-premises\n\n## Manuten√ß√£o e Troubleshooting\n\n### Logs do Sistema\n- Logs dispon√≠veis no console da aplica√ß√£o\n- N√≠vel DEBUG ativado para desenvolvimento\n- Erros de banco de dados logados com detalhes\n\n### Comandos √öteis\n```bash\n# Verificar status do banco\npsql $DATABASE_URL -c \"SELECT COUNT(*) FROM cases;\"\n\n# Backup de casos\npsql $DATABASE_URL -c \"COPY cases TO STDOUT WITH CSV HEADER;\" > backup_casos.csv\n\n# Verificar modelos ML\nls -la ml_models/\n```\n\n### Problemas Comuns\n\n#### 1. Erro de Conex√£o com Banco\n- Verifique as vari√°veis de ambiente DATABASE_URL\n- Reinicie o workflow se necess√°rio\n- Sistema faz fallback para armazenamento em mem√≥ria\n\n#### 2. Importa√ß√£o Falha\n- Verifique se as colunas est√£o nomeadas corretamente\n- Confirme que o arquivo n√£o est√° corrompido\n- Use template fornecido como refer√™ncia\n\n#### 3. ML Models N√£o Carregam\n- Verifique diret√≥rio ml_models/\n- Modelos s√£o retreinados automaticamente com novos dados\n- M√≠nimo de 5 casos necess√°rio para treinamento\n\n## Escalabilidade e Performance\n\n### Otimiza√ß√µes Implementadas\n- **Connection Pooling**: Reutiliza√ß√£o de conex√µes do banco\n- **TF-IDF Caching**: Vetoriza√ß√£o armazenada para reuso\n- **Lazy Loading**: Modelos ML carregados sob demanda\n- **Batch Processing**: Importa√ß√£o otimizada para m√∫ltiplos casos\n\n### Limites Recomendados\n- **Casos**: At√© 10.000 casos mant√©m performance √≥tima\n- **Importa√ß√£o**: Arquivos at√© 5MB recomendados\n- **Busca**: Resultados limitados a 50 casos similares\n\n## Roadmap e Extens√µes Futuras\n\n### Funcionalidades Planejadas\n- Export de dados em m√∫ltiplos formatos\n- Dashboard avan√ßado com gr√°ficos\n- Sistema de notifica√ß√µes para casos cr√≠ticos\n- API REST para integra√ß√£o externa\n- Workflow de aprova√ß√£o para casos sens√≠veis\n\n### Escalabilidade\n- Suporte para m√∫ltiplos bancos de dados\n- Cache distribu√≠do para ML models\n- Balanceamento de carga para alta disponibilidade\n\n---\n\n**Vers√£o do Sistema**: 1.0.0  \n**√öltima Atualiza√ß√£o**: 14 de Agosto de 2025  \n**Ambiente**: Replit Production Environment  \n**Suporte**: Sistema interno - documenta√ß√£o completa dispon√≠vel neste arquivo","size_bytes":8755},"INSTALACAO_VSCODE.md":{"content":"# üéØ Guia de Instala√ß√£o VSCode - Passo a Passo\n\n## üìã O que voc√™ vai precisar\n- Windows/Mac/Linux com Python 3.8+\n- VSCode (Visual Studio Code)\n- 10 minutos do seu tempo\n\n---\n\n## üîß PASSO 1: Verificar Python\n\nAbra o **Prompt de Comando** (Windows) ou **Terminal** (Mac/Linux):\n\n```bash\npython --version\n```\n\n**Resultado esperado:** `Python 3.8.x` ou superior\n\n**Se n√£o funcionar:**\n- Windows: Baixe em https://python.org/downloads\n- Mac: `brew install python3`\n- Ubuntu: `sudo apt install python3 python3-pip`\n\n---\n\n## üìÅ PASSO 2: Preparar Pasta do Projeto\n\n1. **Crie uma pasta** no seu computador (ex: `C:\\OS-Assistant` ou `~/OS-Assistant`)\n2. **Copie TODOS os arquivos** do projeto para essa pasta\n3. **Estrutura deve ficar assim:**\n\n```\nOS-Assistant/\n‚îú‚îÄ‚îÄ README.md\n‚îú‚îÄ‚îÄ run_local.py              ‚Üê IMPORTANTE\n‚îú‚îÄ‚îÄ app.py\n‚îú‚îÄ‚îÄ routes.py\n‚îú‚îÄ‚îÄ models.py\n‚îú‚îÄ‚îÄ case_service.py\n‚îú‚îÄ‚îÄ ml_service.py\n‚îú‚îÄ‚îÄ file_processor.py\n‚îú‚îÄ‚îÄ static/\n‚îÇ   ‚îú‚îÄ‚îÄ style.css\n‚îÇ   ‚îî‚îÄ‚îÄ script.js\n‚îú‚îÄ‚îÄ templates/\n‚îÇ   ‚îú‚îÄ‚îÄ base.html\n‚îÇ   ‚îú‚îÄ‚îÄ index.html\n‚îÇ   ‚îî‚îÄ‚îÄ ... (outros arquivos)\n‚îî‚îÄ‚îÄ ml_models/               ‚Üê Pasta pode estar vazia\n```\n\n---\n\n## üöÄ PASSO 3: Abrir no VSCode\n\n1. **Abra o VSCode**\n2. **File ‚Üí Open Folder** (ou Ctrl+K, Ctrl+O)\n3. **Selecione a pasta** `OS-Assistant`\n4. **Confira**: Voc√™ deve ver todos os arquivos na barra lateral\n\n---\n\n## ‚ö° PASSO 4: Instalar Depend√™ncias\n\n1. **Abra o Terminal integrado** no VSCode:\n   - **Menu:** Terminal ‚Üí New Terminal\n   - **Atalho:** Ctrl+` (aspas simples)\n\n2. **Execute este comando:**\n```bash\npip install flask flask-sqlalchemy pandas openpyxl scikit-learn werkzeug numpy PyPDF2 email-validator\n```\n\n**Aguarde a instala√ß√£o** (pode demorar 2-3 minutos)\n\n**Se der erro de permiss√£o:**\n```bash\npip install --user flask flask-sqlalchemy pandas openpyxl scikit-learn werkzeug numpy PyPDF2 email-validator\n```\n\n---\n\n## üéØ PASSO 5: Executar o Sistema\n\nNo terminal do VSCode, digite:\n\n```bash\npython run_local.py\n```\n\n**Voc√™ deve ver:**\n```\n============================================================\nOS ASSISTANT - Sistema de Suporte T√©cnico Inteligente\n============================================================\nConfigura√ß√£o: SQLite (Banco Local)\nPorta: 5000\nURL: http://localhost:5000\n============================================================\n‚úÖ Banco de dados SQLite inicializado com sucesso\nüìÅ Arquivo do banco: C:\\OS-Assistant\\os_assistant.db\nüìä Casos existentes no banco: 0\n\nüöÄ Iniciando servidor Flask...\nüí° Pressione Ctrl+C para parar o servidor\n============================================================\n```\n\n---\n\n## üåê PASSO 6: Testar no Navegador\n\n1. **Abra seu navegador** (Chrome, Firefox, Edge, Safari)\n2. **Digite:** `http://localhost:5000`\n3. **Deve aparecer** a tela inicial do OS Assistant\n\n**Se n√£o funcionar:**\n- Verifique se n√£o h√° erro no terminal\n- Tente `http://127.0.0.1:5000`\n- Veja se outra aplica√ß√£o est√° usando a porta 5000\n\n---\n\n## üìä PASSO 7: Testar Importa√ß√£o\n\n1. **Prepare uma planilha Excel** com colunas:\n   - **Problema** (descri√ß√£o do problema)\n   - **Solu√ß√£o** (como foi resolvido)\n   - **Sistema** (tipo de sistema)\n\n2. **Na aplica√ß√£o:**\n   - Clique **\"Upload de Casos\"**\n   - Selecione sua planilha\n   - Clique **\"Importar\"**\n\n3. **Verifique no Dashboard** se os casos apareceram\n\n---\n\n## üîß Configura√ß√µes do VSCode (Opcional)\n\n### Extens√µes Recomendadas\n1. **Python** (Microsoft)\n2. **Python Debugger** (Microsoft)\n3. **Pylance** (Microsoft)\n\n### Configurar Python Interpreter\n1. **Ctrl+Shift+P**\n2. **Digite:** `Python: Select Interpreter`\n3. **Escolha** a vers√£o do Python instalada\n\n---\n\n## üö® Solu√ß√µes de Problemas Comuns\n\n### ‚ùå \"python: command not found\"\n**Windows:**\n- Reinstale Python marcando \"Add to PATH\"\n- Use `py` em vez de `python`\n\n**Mac/Linux:**\n- Use `python3` em vez de `python`\n- Instale via gerenciador de pacotes\n\n### ‚ùå \"ModuleNotFoundError: No module named 'flask'\"\n```bash\npip install --upgrade pip\npip install flask flask-sqlalchemy pandas openpyxl scikit-learn\n```\n\n### ‚ùå \"Port 5000 is already in use\"\n**Edite `run_local.py`** linha 57:\n```python\napp.run(port=8080)  # Mude de 5000 para 8080\n```\n\n### ‚ùå \"Permission denied\" ao criar banco\n**Windows:**\n- Execute VSCode como Administrador\n- Verifique antiv√≠rus\n\n**Mac/Linux:**\n```bash\nchmod 755 .\n```\n\n### ‚ùå Importa√ß√£o de Excel falha\n- Verifique se colunas est√£o nomeadas exatamente: \"Problema\", \"Solu√ß√£o\", \"Sistema\"\n- Use arquivo .xlsx (Excel), n√£o .xls\n- Arquivo deve ter menos de 5MB\n\n---\n\n## üìà Pr√≥ximos Passos\n\n### 1. Explorar Funcionalidades\n- ‚úÖ Adicionar casos manualmente\n- ‚úÖ Testar an√°lise de problemas\n- ‚úÖ Verificar dashboard\n- ‚úÖ Importar sua planilha de dados\n\n### 2. Customizar Sistema\n- Adicionar seus sistemas espec√≠ficos\n- Ajustar tipos de problema\n- Configurar tags personalizadas\n\n### 3. Backup dos Dados\n- Copie o arquivo `os_assistant.db` periodicamente\n- Salve a pasta `ml_models/` ap√≥s treinar\n\n---\n\n## üìû Suporte\n\n**Documenta√ß√£o Completa:**\n- `DOCUMENTACAO_SISTEMA.md` - Guia t√©cnico completo\n- `setup_local.md` - Guia de instala√ß√£o detalhado\n\n**Logs de Erro:**\n- Aparecem no terminal do VSCode\n- Copie e cole para debug\n\n**Backup/Restore:**\n- Dados: arquivo `os_assistant.db`\n- Modelos: pasta `ml_models/`\n\n---\n\n## ‚úÖ Checklist Final\n\n- [ ] Python instalado e funcionando\n- [ ] VSCode instalado\n- [ ] Projeto copiado para pasta local\n- [ ] Depend√™ncias instaladas sem erro\n- [ ] `python run_local.py` executa sem erro\n- [ ] http://localhost:5000 carrega a aplica√ß√£o\n- [ ] Teste de importa√ß√£o realizado\n- [ ] Dashboard mostra dados corretamente\n\n**üéâ Parab√©ns! Seu OS Assistant est√° funcionando!**","size_bytes":5779},"README.md":{"content":"# OS Assistant - Sistema de Suporte T√©cnico Inteligente\n\n## üìã Descri√ß√£o\nSistema de machine learning para diagnosticar e resolver problemas t√©cnicos baseado em casos hist√≥ricos. Focado em sistemas hospitalares brasileiros (Tasy, SGU, SGU Card, Autorizador).\n\n## üöÄ Configura√ß√£o R√°pida no VSCode\n\n### 1. Pr√©-requisitos\n- Python 3.8+ instalado\n- VSCode instalado\n- Terminal/Prompt de comando\n\n### 2. Passos de Instala√ß√£o\n\n1. **Clone/Baixe o projeto** para uma pasta local\n2. **Abra a pasta no VSCode**\n3. **Abra o terminal integrado** (Ctrl+` ou Terminal ‚Üí New Terminal)\n4. **Execute os comandos:**\n\n```bash\n# Instalar depend√™ncias\npip install flask flask-sqlalchemy pandas openpyxl scikit-learn werkzeug numpy PyPDF2 email-validator\n\n# Executar o sistema\npython run_local.py\n```\n\n5. **Acesse:** http://localhost:5000\n\n## üìÅ Estrutura do Projeto\n\n```\nOS-Assistant/\n‚îú‚îÄ‚îÄ README.md                  # ‚Üê Este arquivo\n‚îú‚îÄ‚îÄ run_local.py              # ‚Üê Script principal para executar\n‚îú‚îÄ‚îÄ setup_local.md            # ‚Üê Guia detalhado de instala√ß√£o\n‚îú‚îÄ‚îÄ DOCUMENTACAO_SISTEMA.md   # ‚Üê Documenta√ß√£o completa t√©cnica\n‚îú‚îÄ‚îÄ \n‚îú‚îÄ‚îÄ üéØ CORE (Arquivos principais)\n‚îú‚îÄ‚îÄ app.py                    # Configura√ß√£o Flask e banco\n‚îú‚îÄ‚îÄ main.py                   # Ponto de entrada alternativo\n‚îú‚îÄ‚îÄ routes.py                 # Todas as rotas da aplica√ß√£o\n‚îú‚îÄ‚îÄ models.py                 # Modelos do banco de dados\n‚îú‚îÄ‚îÄ \n‚îú‚îÄ‚îÄ üß† SERVICES (L√≥gica de neg√≥cio)\n‚îú‚îÄ‚îÄ case_service.py           # Gerenciamento de casos\n‚îú‚îÄ‚îÄ ml_service.py             # Machine learning interno\n‚îú‚îÄ‚îÄ file_processor.py         # Importa√ß√£o de arquivos Excel\n‚îú‚îÄ‚îÄ \n‚îú‚îÄ‚îÄ üé® FRONTEND\n‚îú‚îÄ‚îÄ static/\n‚îÇ   ‚îú‚îÄ‚îÄ style.css            # Estilos (Bootstrap + customiza√ß√µes)\n‚îÇ   ‚îî‚îÄ‚îÄ script.js            # JavaScript (busca, confirma√ß√µes)\n‚îú‚îÄ‚îÄ templates/               # Templates HTML (Jinja2)\n‚îÇ   ‚îú‚îÄ‚îÄ base.html           # Layout base\n‚îÇ   ‚îú‚îÄ‚îÄ index.html          # P√°gina principal\n‚îÇ   ‚îú‚îÄ‚îÄ dashboard.html      # Dashboard com estat√≠sticas\n‚îÇ   ‚îú‚îÄ‚îÄ add_case.html       # Adicionar caso\n‚îÇ   ‚îú‚îÄ‚îÄ upload_cases.html   # Upload de planilhas\n‚îÇ   ‚îî‚îÄ‚îÄ ... (outros templates)\n‚îú‚îÄ‚îÄ \n‚îú‚îÄ‚îÄ ü§ñ ML MODELS (Auto-gerados)\n‚îî‚îÄ‚îÄ ml_models/              # Modelos treinados (pickle)\n    ‚îú‚îÄ‚îÄ system_classifier.pkl\n    ‚îú‚îÄ‚îÄ label_encoder.pkl\n    ‚îî‚îÄ‚îÄ metadata.pkl\n```\n\n## ‚ö° Funcionalidades Principais\n\n- **üîç An√°lise Inteligente**: IA analisa problemas e sugere solu√ß√µes\n- **üìä Dashboard**: Estat√≠sticas e visualiza√ß√£o de casos\n- **üìÅ Importa√ß√£o Excel**: Carregue centenas de casos via planilha\n- **üîß CRUD Completo**: Criar, editar, visualizar, deletar casos\n- **üîé Busca Inteligente**: Encontra casos similares automaticamente\n- **üè• Sistemas Suportados**: Tasy, SGU, SGU Card, Autorizador\n- **üîí 100% Offline**: Sem depend√™ncias de APIs externas\n\n## üíæ Banco de Dados\n\n- **Desenvolvimento Local**: SQLite (arquivo `os_assistant.db`)\n- **Produ√ß√£o**: PostgreSQL (configura√ß√£o autom√°tica)\n- **Backup**: Simplesmente copie o arquivo `os_assistant.db`\n\n## üì§ Importa√ß√£o de Dados\n\n### Formato de Planilha Excel\nSuas planilhas devem ter estas colunas (exato como est√°):\n\n| Problema | Solu√ß√£o | Sistema |\n|----------|---------|---------|\n| Descri√ß√£o detalhada do problema | Como foi resolvido | Tasy/SGU/etc |\n\n### Como Importar\n1. Menu ‚Üí \"Upload de Casos\"\n2. Selecione arquivo Excel (.xlsx)\n3. Clique \"Importar\"\n4. Aguarde confirma√ß√£o\n\n## üõ†Ô∏è Comandos √öteis\n\n```bash\n# Executar em modo desenvolvimento\npython run_local.py\n\n# Executar em modo produ√ß√£o (alternativo)\npython main.py\n\n# Ver casos no banco\npython -c \"from app import *; with app.app_context(): print(f'Casos: {Case.query.count()}')\"\n```\n\n## üìù Logs e Debug\n\n- **Logs aparecem no terminal** onde executou o comando\n- **Para debug SQL**: Edite `app.py`, linha 49, mude `\"echo\": False` para `True`\n- **Arquivo de log**: N√£o necess√°rio, tudo aparece no console\n\n## üîß Customiza√ß√µes\n\n### Mudar Porta\nEdite `run_local.py`, linha 57:\n```python\napp.run(port=8080)  # Sua porta preferida\n```\n\n### Adicionar Sistemas\nInterface ‚Üí \"Gerenciar Sistemas\" ‚Üí Adicionar\n\n### Backup Autom√°tico\nCopie periodicamente:\n- `os_assistant.db` (dados)\n- `ml_models/` (modelos treinados)\n\n## üö® Solu√ß√£o de Problemas\n\n### Erro: ModuleNotFoundError\n```bash\npip install --upgrade pip\npip install flask flask-sqlalchemy pandas openpyxl scikit-learn\n```\n\n### Erro: \"Port 5000 in use\"\n- Mude a porta em `run_local.py`\n- Ou pare o processo: `pkill -f python`\n\n### Importa√ß√£o Falha\n- Verifique colunas: \"Problema\", \"Solu√ß√£o\", \"Sistema\"\n- Arquivo deve ser .xlsx (Excel)\n- M√°ximo 5MB recomendado\n\n### Performance Lenta\n- Mais de 10.000 casos? Considere limpeza\n- Feche outros programas pesados\n- Use SSD se poss√≠vel\n\n## üìö Documenta√ß√£o Completa\n\n- **setup_local.md**: Guia detalhado de instala√ß√£o\n- **DOCUMENTACAO_SISTEMA.md**: Documenta√ß√£o t√©cnica completa\n- **Coment√°rios no c√≥digo**: Cada arquivo √© bem documentado\n\n## ‚úÖ Checklist de Instala√ß√£o\n\n- [ ] Python 3.8+ instalado\n- [ ] VSCode instalado\n- [ ] Projeto baixado em pasta local\n- [ ] Terminal aberto na pasta do projeto\n- [ ] Depend√™ncias instaladas (`pip install...`)\n- [ ] `python run_local.py` executado\n- [ ] http://localhost:5000 acess√≠vel\n- [ ] Teste de importa√ß√£o realizado\n\n## üéØ Pr√≥ximos Passos\n\n1. Execute `python run_local.py`\n2. Acesse http://localhost:5000\n3. Teste as funcionalidades b√°sicas\n4. Importe seus dados Excel\n5. Configure sistemas personalizados\n6. Explore o dashboard e relat√≥rios\n\n---\n\n**Vers√£o:** 1.0.0 | **Suporte:** Sistema 100% interno | **Licen√ßa:** Uso interno","size_bytes":5835},"app.py":{"content":"import os\nimport logging\nfrom flask import Flask\nfrom flask_sqlalchemy import SQLAlchemy\nfrom sqlalchemy.orm import DeclarativeBase\nfrom werkzeug.middleware.proxy_fix import ProxyFix\n\n# Set up logging for debugging\nlogging.basicConfig(level=logging.DEBUG)\n\nclass Base(DeclarativeBase):\n    pass\n\ndb = SQLAlchemy(model_class=Base)\n\n# Create the Flask app\napp = Flask(__name__)\napp.secret_key = os.environ.get(\"SESSION_SECRET\", \"dev-secret-key-change-in-production\")\napp.wsgi_app = ProxyFix(app.wsgi_app, x_proto=1, x_host=1)\n\n# Configure the database with robust fallback strategy\ndatabase_url = os.environ.get(\"DATABASE_URL\")\nif database_url and \"postgres\" in database_url:\n    # PostgreSQL configuration with connection resilience\n    app.config[\"SQLALCHEMY_DATABASE_URI\"] = database_url\n    app.config[\"SQLALCHEMY_ENGINE_OPTIONS\"] = {\n        \"pool_recycle\": 300,\n        \"pool_pre_ping\": True,\n        \"pool_timeout\": 10,\n        \"pool_size\": 5,\n        \"max_overflow\": 10,\n        \"echo\": False,\n        \"connect_args\": {\n            \"connect_timeout\": 10,\n            \"application_name\": \"os_assistant\"\n        }\n    }\nelse:\n    # SQLite fallback for local development and reliability\n    import os\n    db_path = os.path.join(os.getcwd(), \"os_assistant.db\")\n    app.config[\"SQLALCHEMY_DATABASE_URI\"] = f\"sqlite:///{db_path}\"\n    app.config[\"SQLALCHEMY_ENGINE_OPTIONS\"] = {\n        \"echo\": False,\n        \"connect_args\": {\"timeout\": 20}\n    }\n    \napp.config[\"SQLALCHEMY_TRACK_MODIFICATIONS\"] = False\n\n# Initialize the app with the extension\ndb.init_app(app)\n\n# Initialize in-memory storage for prototyping (will migrate to DB later)\napp.config['CASES_STORAGE'] = []\napp.config['NEXT_CASE_ID'] = 1\n\nwith app.app_context():\n    # Make sure to import the models here\n    import models\n    db.create_all()\n\n# Import routes after app creation to avoid circular imports\nfrom routes import *\n","size_bytes":1890},"case_service.py":{"content":"import logging\nfrom typing import List, Dict, Optional\nfrom datetime import datetime, timedelta\nfrom flask import current_app\nfrom models import Case, CaseFeedback\nfrom app import db\nfrom sklearn.feature_extraction.text import TfidfVectorizer\nfrom sklearn.metrics.pairwise import cosine_similarity\nimport numpy as np\n\nclass CaseService:\n    \"\"\"Service for managing cases and performing similarity searches\"\"\"\n    \n    def __init__(self):\n        self.vectorizer = TfidfVectorizer(stop_words='english', max_features=1000)\n        self._fitted = False\n    \n    def get_all_cases(self) -> List[Case]:\n        \"\"\"Get all cases from database with fallback\"\"\"\n        try:\n            return Case.query.all()\n        except Exception as e:\n            logging.error(f\"Error getting cases from database: {str(e)}\")\n            # Fallback to in-memory storage\n            return current_app.config.get('CASES_STORAGE', [])\n    \n    def get_case_by_id(self, case_id: int) -> Optional[Case]:\n        \"\"\"Get a specific case by ID from PostgreSQL\"\"\"\n        try:\n            return Case.query.get(case_id)\n        except Exception as e:\n            logging.error(f\"Error getting case {case_id} from database: {str(e)}\")\n            # Fallback to in-memory storage\n            cases = current_app.config.get('CASES_STORAGE', [])\n            for case in cases:\n                if case.id == case_id:\n                    return case\n            return None\n    \n    def add_case(self, problem_description: str, solution: str, system_type: str = \"Unknown\") -> Case:\n        \"\"\"Add a new case to the database with robust error handling\"\"\"\n        max_retries = 3\n        retry_count = 0\n        \n        while retry_count < max_retries:\n            try:\n                # Create new case\n                case = Case()\n                case.problem_description = problem_description\n                case.solution = solution\n                case.system_type = system_type\n                \n                # Add to database\n                db.session.add(case)\n                db.session.commit()\n                \n                # Refit vectorizer when new cases are added\n                self._fitted = False\n                \n                logging.info(f\"Added new case #{case.id} to database\")\n                return case\n                \n            except Exception as e:\n                retry_count += 1\n                try:\n                    db.session.rollback()\n                except:\n                    pass\n                    \n                if retry_count < max_retries:\n                    logging.warning(f\"Database error on attempt {retry_count}, retrying: {str(e)}\")\n                    continue\n                else:\n                    logging.error(f\"Failed to add case to database after {max_retries} attempts: {str(e)}\")\n                    # Fallback to in-memory storage\n                    next_id = current_app.config.get('NEXT_CASE_ID', 1)\n                    current_app.config['NEXT_CASE_ID'] = next_id + 1\n                    case = Case()\n                    case.problem_description = problem_description\n                    case.solution = solution\n                    case.system_type = system_type\n                    case.id = next_id\n                    cases = current_app.config.get('CASES_STORAGE', [])\n                    cases.append(case)\n                    current_app.config['CASES_STORAGE'] = cases\n                    logging.info(f\"Added case #{case.id} to in-memory storage (fallback)\")\n                    return case\n    \n    def update_case(self, case_id: int, problem_description: str, solution: str, system_type: str) -> bool:\n        \"\"\"Update an existing case in PostgreSQL\"\"\"\n        try:\n            case = Case.query.get(case_id)\n            if case:\n                case.problem_description = problem_description\n                case.solution = solution\n                case.system_type = system_type\n                \n                db.session.commit()\n                \n                # Refit vectorizer when cases are updated\n                self._fitted = False\n                \n                logging.info(f\"Updated case #{case_id} in database\")\n                return True\n            \n            return False  # Case not found\n            \n        except Exception as e:\n            db.session.rollback()\n            logging.error(f\"Error updating case {case_id} in database: {str(e)}\")\n            return False\n    \n    def delete_case(self, case_id: int) -> bool:\n        \"\"\"Delete a case from PostgreSQL database\"\"\"\n        try:\n            case = Case.query.get(case_id)\n            if case:\n                db.session.delete(case)\n                db.session.commit()\n                \n                # Refit vectorizer when cases are deleted\n                self._fitted = False\n                \n                logging.info(f\"Deleted case #{case_id} from database\")\n                return True\n            \n            return False  # Case not found\n            \n        except Exception as e:\n            db.session.rollback()\n            logging.error(f\"Error deleting case {case_id} from database: {str(e)}\")\n            return False\n            \n    def add_case_feedback(self, case_id: int, effectiveness_score: int, \n                         resolution_method: str = \"\", custom_solution: str = \"\") -> bool:\n        \"\"\"Add feedback to a case\"\"\"\n        try:\n            case = Case.query.get(case_id)\n            if not case:\n                return False\n                \n            # Add feedback using the model method\n            case.add_feedback(effectiveness_score, resolution_method, custom_solution)\n            db.session.commit()\n            \n            logging.info(f\"Added feedback to case #{case_id}: {resolution_method} (score: {effectiveness_score})\")\n            return True\n            \n        except Exception as e:\n            db.session.rollback()\n            logging.error(f\"Error adding feedback to case {case_id}: {str(e)}\")\n            return False\n    \n    def get_case_feedbacks(self, case_id: int) -> List[CaseFeedback]:\n        \"\"\"Get all feedback for a specific case\"\"\"\n        try:\n            return CaseFeedback.query.filter_by(case_id=case_id).order_by(CaseFeedback.created_at.desc()).all()\n        except Exception as e:\n            logging.error(f\"Error getting feedbacks for case {case_id}: {str(e)}\")\n            return []\n    \n    def find_similar_cases(self, problem_description: str, limit: int = 5) -> List[Case]:\n        \"\"\"Find cases similar to the given problem description\"\"\"\n        try:\n            cases = self.get_all_cases()\n            \n            if not cases:\n                return []\n            \n            # Prepare text corpus\n            case_descriptions = [case.problem_description for case in cases]\n            all_descriptions = case_descriptions + [problem_description]\n            \n            # Fit or refit vectorizer if needed\n            if not self._fitted or len(case_descriptions) > 0:\n                try:\n                    tfidf_matrix = self.vectorizer.fit_transform(all_descriptions)\n                    self._fitted = True\n                except Exception as e:\n                    logging.error(f\"Error fitting vectorizer: {str(e)}\")\n                    return []\n            else:\n                return []\n            \n            # Calculate similarities\n            query_vector = tfidf_matrix[-1]  # Last item is the query\n            case_vectors = tfidf_matrix[:-1]  # All except the last\n            \n            similarities = cosine_similarity(query_vector, case_vectors).flatten()\n            \n            # Get top similar cases\n            similar_indices = np.argsort(similarities)[::-1][:limit]\n            similar_cases = []\n            \n            for idx in similar_indices:\n                if similarities[idx] > 0.1:  # Minimum similarity threshold\n                    similar_cases.append(cases[idx])\n            \n            return similar_cases\n            \n        except Exception as e:\n            logging.error(f\"Error finding similar cases: {str(e)}\")\n            return []\n    \n    def search_cases(self, query: str, system_filter: str = \"\") -> List[Case]:\n        \"\"\"Search cases by query and optional system filter\"\"\"\n        try:\n            cases = self.get_all_cases()\n            \n            if not query and not system_filter:\n                return cases\n            \n            filtered_cases = []\n            \n            for case in cases:\n                # Apply system filter\n                if system_filter and case.system_type.lower() != system_filter.lower():\n                    continue\n                \n                # Apply text search\n                if query:\n                    query_lower = query.lower()\n                    if (query_lower in case.problem_description.lower() or \n                        query_lower in case.solution.lower()):\n                        filtered_cases.append(case)\n                else:\n                    filtered_cases.append(case)\n            \n            return filtered_cases\n            \n        except Exception as e:\n            logging.error(f\"Error searching cases: {str(e)}\")\n            return []\n    \n    def get_recent_cases(self, limit: int = 10) -> List[Case]:\n        \"\"\"Get most recently added cases\"\"\"\n        try:\n            cases = self.get_all_cases()\n            # Sort by creation date (most recent first)\n            sorted_cases = sorted(cases, key=lambda x: x.created_at, reverse=True)\n            return sorted_cases[:limit]\n            \n        except Exception as e:\n            logging.error(f\"Error getting recent cases: {str(e)}\")\n            return []\n    \n    def get_statistics(self) -> Dict:\n        \"\"\"Get system statistics\"\"\"\n        try:\n            cases = self.get_all_cases()\n            \n            if not cases:\n                return {\n                    'total_cases': 0,\n                    'systems': {},\n                    'avg_effectiveness': 0,\n                    'cases_with_feedback': 0,\n                    'recent_activity': 0\n                }\n            \n            # Count by system type\n            systems = {}\n            total_effectiveness = 0\n            cases_with_feedback = 0\n            recent_cases = 0\n            \n            week_ago = datetime.now() - timedelta(days=7)\n            \n            for case in cases:\n                # System type counts\n                systems[case.system_type] = systems.get(case.system_type, 0) + 1\n                \n                # Effectiveness tracking\n                if case.effectiveness_score is not None:\n                    total_effectiveness += case.effectiveness_score\n                    cases_with_feedback += 1\n                \n                # Recent activity\n                if case.created_at > week_ago:\n                    recent_cases += 1\n            \n            avg_effectiveness = (total_effectiveness / cases_with_feedback) if cases_with_feedback > 0 else 0\n            \n            return {\n                'total_cases': len(cases),\n                'systems': systems,\n                'avg_effectiveness': round(avg_effectiveness, 2),\n                'cases_with_feedback': cases_with_feedback,\n                'recent_activity': recent_cases\n            }\n            \n        except Exception as e:\n            logging.error(f\"Error getting statistics: {str(e)}\")\n            return {\n                'total_cases': 0,\n                'systems': {},\n                'avg_effectiveness': 0,\n                'cases_with_feedback': 0,\n                'recent_activity': 0\n            }\n    \n    def get_unique_systems(self) -> List[str]:\n        \"\"\"Get list of unique system types\"\"\"\n        try:\n            cases = self.get_all_cases()\n            systems = set(case.system_type for case in cases)\n            return sorted(list(systems))\n            \n        except Exception as e:\n            logging.error(f\"Error getting unique systems: {str(e)}\")\n            return []\n    \n    def add_feedback(self, case_id: int, effectiveness: int) -> bool:\n        \"\"\"Add effectiveness feedback to a case\"\"\"\n        try:\n            case = self.get_case_by_id(case_id)\n            if case:\n                case.add_feedback(effectiveness)\n                logging.info(f\"Added feedback to case #{case_id}: {effectiveness}\")\n                return True\n            return False\n            \n        except Exception as e:\n            logging.error(f\"Error adding feedback: {str(e)}\")\n            return False\n","size_bytes":12589},"file_processor.py":{"content":"\"\"\"\nFile processing module for importing cases from various file formats\n\"\"\"\nimport os\nimport logging\nimport pandas as pd\nfrom typing import List, Dict, Optional\nimport csv\nfrom io import StringIO\nimport json\n\ntry:\n    import PyPDF2\n    PDF_AVAILABLE = True\nexcept ImportError:\n    PDF_AVAILABLE = False\n\ntry:\n    from openai import OpenAI\n    OPENAI_AVAILABLE = True\nexcept ImportError:\n    OPENAI_AVAILABLE = False\n\nclass FileProcessor:\n    def __init__(self):\n        # Sistema 100% interno - sem OpenAI\n        self.openai_client = None\n    \n    def process_file(self, file_path: str, format_type: str = \"auto\") -> List[Dict[str, str]]:\n        \"\"\"\n        Process uploaded file and extract cases\n        \n        Args:\n            file_path: Path to the uploaded file\n            format_type: Only 'structured' supported - no external AI processing\n        \n        Returns:\n            List of dictionaries with 'system_type', 'problem_description', 'solution'\n        \"\"\"\n        file_extension = os.path.splitext(file_path)[1].lower()\n        \n        try:\n            # Sistema interno - apenas formatos estruturados\n            if format_type != \"structured\":\n                raise ValueError(\"Apenas formato estruturado √© suportado (sistema 100% interno)\")\n            \n            # Extract raw content based on file type\n            if file_extension in ['.xlsx', '.xls']:\n                content = self._process_excel(file_path, format_type)\n            elif file_extension == '.csv':\n                content = self._process_csv(file_path, format_type)\n            elif file_extension == '.txt':\n                content = self._process_txt(file_path, format_type)\n            elif file_extension == '.pdf' and PDF_AVAILABLE:\n                content = self._process_pdf(file_path, format_type)\n            else:\n                raise ValueError(f\"Formato de arquivo n√£o suportado: {file_extension}\")\n            \n            return content\n            \n        except Exception as e:\n            logging.error(f\"Erro ao processar arquivo {file_path}: {str(e)}\")\n            raise\n    \n    def _process_excel(self, file_path: str, format_type: str) -> List[Dict[str, str]]:\n        \"\"\"Process Excel files\"\"\"\n        df = pd.read_excel(file_path)\n        return self._process_structured_dataframe(df)\n    \n    def _process_csv(self, file_path: str, format_type: str) -> List[Dict[str, str]]:\n        \"\"\"Process CSV files\"\"\"\n        df = pd.read_csv(file_path)\n        return self._process_structured_dataframe(df)\n    \n    def _process_txt(self, file_path: str, format_type: str) -> List[Dict[str, str]]:\n        \"\"\"Process text files\"\"\"\n        with open(file_path, 'r', encoding='utf-8') as f:\n            content = f.read()\n        return self._process_structured_text(content)\n    \n    def _process_pdf(self, file_path: str, format_type: str) -> List[Dict[str, str]]:\n        \"\"\"Process PDF files\"\"\"\n        if not PDF_AVAILABLE:\n            raise ValueError(\"PyPDF2 n√£o est√° dispon√≠vel para processar arquivos PDF\")\n        \n        import PyPDF2\n        with open(file_path, 'rb') as f:\n            reader = PyPDF2.PdfReader(f)\n            content = \"\"\n            for page in reader.pages:\n                content += page.extract_text() + \"\\n\"\n        \n        return self._process_structured_text(content)\n    \n    def _process_structured_dataframe(self, df: pd.DataFrame) -> List[Dict[str, str]]:\n        \"\"\"Process structured Excel/CSV with expected columns\"\"\"\n        cases = []\n        \n        # Try to find relevant columns (case-insensitive)\n        columns = {col.lower(): col for col in df.columns}\n        \n        system_col = None\n        problem_col = None\n        solution_col = None\n        \n        # Map common column names (including Portuguese variations)\n        for col_lower, col_original in columns.items():\n            if any(word in col_lower for word in ['sistema', 'system', 'tipo']):\n                system_col = col_original\n            elif any(word in col_lower for word in ['problema', 'problem', 'issue', 'erro', 'error']):\n                problem_col = col_original\n            elif any(word in col_lower for word in ['solu√ß√£o', 'solu√ßao', 'solution', 'resolu√ß√£o', 'resolucao', 'fix']):\n                solution_col = col_original\n        \n        if not problem_col or not solution_col:\n            raise ValueError(\"N√£o foi poss√≠vel identificar as colunas de problema e solu√ß√£o no arquivo\")\n        \n        for _, row in df.iterrows():\n            # Skip empty rows\n            if pd.isna(row[problem_col]).any() if hasattr(pd.isna(row[problem_col]), 'any') else pd.isna(row[problem_col]) or \\\n               pd.isna(row[solution_col]).any() if hasattr(pd.isna(row[solution_col]), 'any') else pd.isna(row[solution_col]):\n                continue\n                \n            system_val = row[system_col] if system_col else None\n            case = {\n                'system_type': str(system_val).strip() if system_col and not (pd.isna(system_val).any() if hasattr(pd.isna(system_val), 'any') else pd.isna(system_val)) else 'Desconhecido',\n                'problem_description': str(row[problem_col]).strip(),\n                'solution': str(row[solution_col]).strip()\n            }\n            \n            # Only add cases with meaningful content\n            if (case['problem_description'] and case['solution'] and \n                case['problem_description'] != 'nan' and case['solution'] != 'nan' and\n                len(case['problem_description']) > 10 and len(case['solution']) > 10):\n                cases.append(case)\n        \n        return cases\n    \n    def _process_structured_text(self, content: str) -> List[Dict[str, str]]:\n        \"\"\"Process structured text with separators\"\"\"\n        cases = []\n        \n        # Split by common separators\n        sections = []\n        if \"---\" in content:\n            sections = content.split(\"---\")\n        elif \"\\n\\n\\n\" in content:\n            sections = content.split(\"\\n\\n\\n\")\n        else:\n            sections = content.split(\"\\n\\n\")\n        \n        for section in sections:\n            section = section.strip()\n            if not section:\n                continue\n            \n            case = self._extract_case_from_text(section)\n            if case:\n                cases.append(case)\n        \n        return cases\n    \n    def _extract_case_from_text(self, text: str) -> Optional[Dict[str, str]]:\n        \"\"\"Extract a case from a text section\"\"\"\n        lines = [line.strip() for line in text.split('\\n') if line.strip()]\n        \n        if len(lines) < 2:\n            return None\n        \n        system_type = \"Desconhecido\"\n        problem_description = \"\"\n        solution = \"\"\n        \n        current_section = \"problem\"\n        \n        for line in lines:\n            # Check for section headers\n            line_lower = line.lower()\n            if any(word in line_lower for word in ['sistema:', 'system:']):\n                system_type = line.split(':', 1)[1].strip()\n            elif any(word in line_lower for word in ['problema:', 'problem:', 'issue:']):\n                current_section = \"problem\"\n                if ':' in line:\n                    problem_description += line.split(':', 1)[1].strip() + \" \"\n            elif any(word in line_lower for word in ['solu√ß√£o:', 'solution:', 'fix:']):\n                current_section = \"solution\"\n                if ':' in line:\n                    solution += line.split(':', 1)[1].strip() + \" \"\n            else:\n                # Add to current section\n                if current_section == \"problem\":\n                    problem_description += line + \" \"\n                elif current_section == \"solution\":\n                    solution += line + \" \"\n        \n        if problem_description.strip() and solution.strip():\n            return {\n                'system_type': system_type,\n                'problem_description': problem_description.strip(),\n                'solution': solution.strip()\n            }\n        \n        return None\n    \n","size_bytes":8050},"main.py":{"content":"from app import app\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=5000, debug=True)\n","size_bytes":99},"ml_service.py":{"content":"import os\nimport pickle\nimport logging\nimport re\nimport numpy as np\nfrom typing import List, Dict, Tuple, Optional\nfrom datetime import datetime\nfrom sklearn.feature_extraction.text import TfidfVectorizer\nfrom sklearn.svm import SVC\nfrom sklearn.naive_bayes import MultinomialNB\nfrom sklearn.metrics.pairwise import cosine_similarity\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.preprocessing import LabelEncoder\nfrom models import SolutionSuggestion, Case\n\nclass MLService:\n    \"\"\"Machine Learning service for problem analysis and solution suggestions\"\"\"\n    \n    def __init__(self):\n        self.system_classifier = None\n        self.solution_generator = None\n        self.vectorizer = TfidfVectorizer(\n            stop_words='english', \n            max_features=1000,\n            ngram_range=(1, 2),\n            min_df=1\n        )\n        self.label_encoder = LabelEncoder()\n        self.is_trained = False\n        \n        # Pre-defined system types and their keywords\n        self.system_keywords = {\n            'Tasy': ['tasy', 'hospitalar', 'hospital', 'prontuario', 'paciente', 'atendimento', 'medico'],\n            'SGU': ['sgu', 'sistema de gestao', 'gestao hospitalar', 'modulo sgu'],\n            'SGU Card': ['sgu card', 'cartao', 'card', 'credenciamento', 'carteirinha'],\n            'Autorizador': ['autorizador', 'autorizacao', 'autorizar', 'procedimento', 'guia'],\n            'Healthcare': ['saude', 'health', 'emr', 'ehr', 'clinico', 'diagnostico', 'exame'],\n            'Administrative': ['administrativo', 'admin', 'rh', 'financeiro', 'contabil', 'gestao'],\n            'Network': ['rede', 'network', 'router', 'switch', 'firewall', 'ip', 'dns', 'dhcp'],\n            'Database': ['banco', 'database', 'sql', 'mysql', 'postgres', 'oracle', 'mongodb'],\n            'Application Server': ['servidor', 'server', 'apache', 'nginx', 'tomcat', 'iis', 'aplicacao']\n        }\n        \n        # Common solutions patterns\n        self.solution_patterns = {\n            'restart': ['Reiniciar o servi√ßo', 'Verificar se o processo est√° rodando', 'Realizar restart do sistema'],\n            'permissions': ['Verificar permiss√µes de usu√°rio', 'Checar grupos de acesso', 'Validar credenciais'],\n            'network': ['Testar conectividade de rede', 'Verificar configura√ß√µes de firewall', 'Validar DNS'],\n            'database': ['Verificar conex√£o com banco de dados', 'Checar logs do banco', 'Validar consultas SQL'],\n            'memory': ['Verificar uso de mem√≥ria', 'Limpar cache', 'Reiniciar servi√ßos que consomem muita RAM'],\n            'disk': ['Verificar espa√ßo em disco', 'Limpar arquivos tempor√°rios', 'Mover arquivos grandes']\n        }\n        \n        # Load trained models if they exist\n        self._load_models()\n    \n    def analyze_problem(self, problem_description: str) -> SolutionSuggestion:\n        \"\"\"Analyze problem description and provide ML-based suggestions\"\"\"\n        try:\n            # Detect system type\n            system_type = self._detect_system_type(problem_description)\n            \n            # Generate solution suggestions\n            suggestions = self._generate_solutions(problem_description, system_type)\n            \n            # Calculate confidence\n            confidence = self._calculate_confidence(problem_description, system_type, suggestions)\n            \n            return SolutionSuggestion(\n                problem_description=problem_description,\n                suggested_solutions=suggestions,\n                confidence=confidence,\n                system_type=system_type\n            )\n            \n        except Exception as e:\n            logging.error(f\"Error in ML analysis: {str(e)}\")\n            return SolutionSuggestion(\n                problem_description=problem_description,\n                suggested_solutions=[\"Erro na an√°lise ML. Consulte a base de conhecimento manualmente.\"],\n                confidence=0.1,\n                system_type=\"Unknown\"\n            )\n    \n    def _detect_system_type(self, problem_description: str) -> str:\n        \"\"\"Detect system type using keyword matching and ML if available\"\"\"\n        problem_lower = problem_description.lower()\n        \n        # Score each system type based on keywords\n        scores = {}\n        for system, keywords in self.system_keywords.items():\n            score = 0\n            for keyword in keywords:\n                if keyword in problem_lower:\n                    score += 1\n            scores[system] = score\n        \n        # Get the system with highest score\n        if scores and max(scores.values()) > 0:\n            detected_system = max(scores.keys(), key=lambda k: scores[k])\n            return detected_system\n        \n        # If no keywords matched, try ML classifier if trained\n        if self.system_classifier and self.is_trained:\n            try:\n                prediction = self.system_classifier.predict([problem_description])\n                return self.label_encoder.inverse_transform(prediction)[0]\n            except Exception as e:\n                logging.error(f\"Error in ML system detection: {str(e)}\")\n        \n        return \"Unknown\"\n    \n    def _generate_solutions(self, problem_description: str, system_type: str) -> List[str]:\n        \"\"\"Generate solution suggestions based on problem patterns\"\"\"\n        problem_lower = problem_description.lower()\n        suggestions = []\n        \n        # Pattern-based solution generation\n        if any(word in problem_lower for word in ['nao', 'n√£o', 'erro', 'falha', 'problem']):\n            if any(word in problem_lower for word in ['conectar', 'conexao', 'rede', 'network']):\n                suggestions.extend(self.solution_patterns['network'])\n            \n            if any(word in problem_lower for word in ['banco', 'database', 'sql']):\n                suggestions.extend(self.solution_patterns['database'])\n            \n            if any(word in problem_lower for word in ['memoria', 'memory', 'ram', 'lento', 'slow']):\n                suggestions.extend(self.solution_patterns['memory'])\n            \n            if any(word in problem_lower for word in ['disco', 'disk', 'espaco', 'space']):\n                suggestions.extend(self.solution_patterns['disk'])\n            \n            if any(word in problem_lower for word in ['permiss', 'acesso', 'login', 'auth']):\n                suggestions.extend(self.solution_patterns['permissions'])\n        \n        # If no specific patterns matched, add generic restart solution\n        if not suggestions:\n            suggestions.extend(self.solution_patterns['restart'])\n        \n        # Add system-specific solutions\n        system_specific = self._get_system_specific_solutions(system_type, problem_description)\n        suggestions.extend(system_specific)\n        \n        # Remove duplicates and limit to 5 suggestions\n        unique_suggestions = list(dict.fromkeys(suggestions))[:5]\n        \n        return unique_suggestions if unique_suggestions else [\n            \"Verificar logs do sistema para mais detalhes\",\n            \"Contactar suporte t√©cnico se o problema persistir\",\n            \"Documentar os passos que levaram ao problema\"\n        ]\n    \n    def _get_system_specific_solutions(self, system_type: str, problem_description: str) -> List[str]:\n        \"\"\"Get system-specific solution suggestions\"\"\"\n        solutions = []\n        \n        if system_type == \"Tasy\":\n            solutions = [\n                \"Verificar configura√ß√µes do m√≥dulo Tasy espec√≠fico\",\n                \"Consultar logs do sistema Tasy\",\n                \"Verificar integridade da base de dados Tasy\",\n                \"Checar configura√ß√µes de usu√°rio no Tasy\",\n                \"Verificar se problema requer chamado para Nexdow\"\n            ]\n        elif system_type == \"SGU\":\n            solutions = [\n                \"Verificar status dos servi√ßos SGU\",\n                \"Consultar logs de erro do SGU\",\n                \"Checar conectividade com base de dados SGU\",\n                \"Validar configura√ß√µes de m√≥dulos SGU\",\n                \"Considerar abertura de chamado Nexdow se necess√°rio\"\n            ]\n        elif system_type == \"SGU Card\":\n            solutions = [\n                \"Verificar servi√ßos de credenciamento\",\n                \"Consultar logs do m√≥dulo Card\",\n                \"Checar sincroniza√ß√£o de dados de carteirinha\",\n                \"Validar configura√ß√µes de impress√£o de cart√µes\",\n                \"Abrir chamado Nexdow se problema persistir\"\n            ]\n        elif system_type == \"Autorizador\":\n            solutions = [\n                \"Verificar fila de autoriza√ß√µes pendentes\",\n                \"Consultar logs do sistema autorizador\",\n                \"Checar conectividade com operadoras\",\n                \"Validar regras de autoriza√ß√£o\",\n                \"Escalar para Nexdow casos complexos\"\n            ]\n        elif system_type == \"Healthcare\":\n            solutions = [\n                \"Verificar conectividade com sistemas de sa√∫de\",\n                \"Validar protocolos de comunica√ß√£o HL7/FHIR\",\n                \"Checar configura√ß√µes de prontu√°rio eletr√¥nico\"\n            ]\n        elif system_type == \"Network\":\n            solutions = [\n                \"Verificar configura√ß√µes de switch/router\",\n                \"Testar conectividade ping/traceroute\",\n                \"Analisar logs de firewall\",\n                \"Verificar configura√ß√µes VLAN\"\n            ]\n        elif system_type == \"Database\":\n            solutions = [\n                \"Verificar performance de queries\",\n                \"Analisar locks e deadlocks\",\n                \"Checar espa√ßo em tablespaces\",\n                \"Validar backup e recovery\"\n            ]\n        \n        # Add generic Nexdow escalation option\n        solutions.append(\"Se problema n√£o for resolvido, abrir chamado para Nexdow\")\n        \n        return solutions\n    \n    def _calculate_confidence(self, problem_description: str, system_type: str, suggestions: List[str]) -> float:\n        \"\"\"Calculate confidence score based on various factors\"\"\"\n        confidence = 0.5  # Base confidence\n        \n        # Increase confidence based on description length and detail\n        if len(problem_description) > 50:\n            confidence += 0.1\n        if len(problem_description) > 100:\n            confidence += 0.1\n        if len(problem_description) > 200:\n            confidence += 0.1\n        \n        # Increase confidence if system type is detected\n        if system_type != \"Unknown\":\n            confidence += 0.2\n        \n        # Increase confidence based on number of relevant suggestions\n        if len(suggestions) >= 3:\n            confidence += 0.1\n        \n        # Check for technical keywords\n        technical_keywords = ['erro', 'falha', 'exception', 'timeout', 'connection', 'database', 'server']\n        keyword_count = sum(1 for keyword in technical_keywords if keyword in problem_description.lower())\n        confidence += min(keyword_count * 0.05, 0.2)\n        \n        return min(confidence, 1.0)\n    \n    def train_models(self, cases: List[Case]) -> bool:\n        \"\"\"Train ML models with existing cases\"\"\"\n        if len(cases) < 5:  # Need minimum cases to train\n            logging.info(\"Not enough cases to train ML models\")\n            return False\n        \n        try:\n            # Prepare training data\n            descriptions = [case.problem_description for case in cases]\n            system_types = [case.system_type for case in cases if case.system_type != \"Unknown\"]\n            \n            if len(system_types) < 3:  # Need minimum variety\n                logging.info(\"Not enough system type variety to train classifier\")\n                return False\n            \n            # Train system type classifier\n            filtered_descriptions = [cases[i].problem_description for i, case in enumerate(cases) \n                                   if case.system_type != \"Unknown\"]\n            \n            if len(filtered_descriptions) >= 3:\n                # Encode labels\n                encoded_labels = self.label_encoder.fit_transform(system_types)\n                \n                # Create and train pipeline\n                self.system_classifier = Pipeline([\n                    ('tfidf', TfidfVectorizer(stop_words='english', max_features=500)),\n                    ('classifier', MultinomialNB())\n                ])\n                \n                self.system_classifier.fit(filtered_descriptions, encoded_labels)\n                self.is_trained = True\n                \n                # Save models\n                self._save_models()\n                \n                logging.info(f\"Trained ML models with {len(cases)} cases\")\n                return True\n            \n            return False\n            \n        except Exception as e:\n            logging.error(f\"Error training ML models: {str(e)}\")\n            return False\n    \n    def _save_models(self):\n        \"\"\"Save trained models to disk\"\"\"\n        try:\n            models_dir = \"ml_models\"\n            os.makedirs(models_dir, exist_ok=True)\n            \n            if self.system_classifier:\n                with open(f\"{models_dir}/system_classifier.pkl\", \"wb\") as f:\n                    pickle.dump(self.system_classifier, f)\n            \n            if hasattr(self, 'label_encoder'):\n                with open(f\"{models_dir}/label_encoder.pkl\", \"wb\") as f:\n                    pickle.dump(self.label_encoder, f)\n            \n            # Save training metadata\n            metadata = {\n                'trained_at': datetime.now().isoformat(),\n                'is_trained': self.is_trained\n            }\n            with open(f\"{models_dir}/metadata.pkl\", \"wb\") as f:\n                pickle.dump(metadata, f)\n                \n        except Exception as e:\n            logging.error(f\"Error saving ML models: {str(e)}\")\n    \n    def _load_models(self):\n        \"\"\"Load trained models from disk\"\"\"\n        try:\n            models_dir = \"ml_models\"\n            \n            # Load system classifier\n            classifier_path = f\"{models_dir}/system_classifier.pkl\"\n            if os.path.exists(classifier_path):\n                with open(classifier_path, \"rb\") as f:\n                    self.system_classifier = pickle.load(f)\n            \n            # Load label encoder\n            encoder_path = f\"{models_dir}/label_encoder.pkl\"\n            if os.path.exists(encoder_path):\n                with open(encoder_path, \"rb\") as f:\n                    self.label_encoder = pickle.load(f)\n            \n            # Load metadata\n            metadata_path = f\"{models_dir}/metadata.pkl\"\n            if os.path.exists(metadata_path):\n                with open(metadata_path, \"rb\") as f:\n                    metadata = pickle.load(f)\n                    self.is_trained = metadata.get('is_trained', False)\n            \n            if self.system_classifier and self.is_trained:\n                logging.info(\"Loaded trained ML models\")\n            \n        except Exception as e:\n            logging.error(f\"Error loading ML models: {str(e)}\")\n            self.is_trained = False\n    \n    def get_model_info(self) -> Dict:\n        \"\"\"Get information about trained models\"\"\"\n        return {\n            'is_trained': self.is_trained,\n            'has_system_classifier': self.system_classifier is not None,\n            'supported_systems': list(self.system_keywords.keys()),\n            'solution_patterns': len(self.solution_patterns)\n        }","size_bytes":15469},"models.py":{"content":"from app import db\nfrom datetime import datetime\nfrom typing import List, Dict, Optional\nfrom flask_sqlalchemy import SQLAlchemy\n\n\nclass Case(db.Model):\n    \"\"\"Model for storing work order cases\"\"\"\n    \n    __tablename__ = 'cases'\n    \n    id = db.Column(db.Integer, primary_key=True)\n    problem_description = db.Column(db.Text, nullable=False)\n    solution = db.Column(db.Text, nullable=False)\n    system_type = db.Column(db.String(100), default=\"Unknown\")\n    created_at = db.Column(db.DateTime, default=datetime.now)\n    effectiveness_score = db.Column(db.Float, nullable=True)\n    feedback_count = db.Column(db.Integer, default=0)\n    tags = db.Column(db.String(500), default=\"\")  # Stored as comma-separated string\n    \n    # Relationship to feedback entries\n    feedbacks = db.relationship(\"CaseFeedback\", backref=\"case\", cascade=\"all, delete-orphan\")\n    \n    def get_tags_list(self) -> List[str]:\n        \"\"\"Get tags as a list\"\"\"\n        return [tag.strip() for tag in self.tags.split(',') if tag.strip()] if self.tags else []\n    \n    def set_tags_list(self, tags: List[str]):\n        \"\"\"Set tags from a list\"\"\"\n        self.tags = ','.join(tags) if tags else \"\"\n        \n    def to_dict(self) -> Dict:\n        \"\"\"Convert case to dictionary for JSON serialization\"\"\"\n        return {\n            'id': self.id,\n            'problem_description': self.problem_description,\n            'solution': self.solution,\n            'system_type': self.system_type,\n            'created_at': self.created_at.isoformat() if self.created_at else None,\n            'effectiveness_score': self.effectiveness_score,\n            'feedback_count': self.feedback_count,\n            'tags': self.get_tags_list()\n        }\n    \n    def add_feedback(self, effectiveness: int, resolution_method: str = \"\", \n                    custom_solution: str = \"\"):\n        \"\"\"Add effectiveness feedback (1-5 scale)\"\"\"\n        if self.effectiveness_score is None:\n            self.effectiveness_score = effectiveness\n        else:\n            # Calculate running average\n            total_score = self.effectiveness_score * self.feedback_count + effectiveness\n            self.effectiveness_score = total_score / (self.feedback_count + 1)\n        \n        self.feedback_count += 1\n        \n        # Create feedback record\n        feedback = CaseFeedback()\n        feedback.case_id = self.id\n        feedback.effectiveness_score = effectiveness\n        feedback.resolution_method = resolution_method\n        feedback.custom_solution = custom_solution\n        db.session.add(feedback)\n        db.session.commit()\n\n\nclass CaseFeedback(db.Model):\n    \"\"\"Model for storing detailed feedback on case resolutions\"\"\"\n    \n    __tablename__ = 'case_feedbacks'\n    \n    id = db.Column(db.Integer, primary_key=True)\n    case_id = db.Column(db.Integer, db.ForeignKey('cases.id'), nullable=False)\n    effectiveness_score = db.Column(db.Integer, nullable=False)  # 1-5 scale\n    resolution_method = db.Column(db.String(50), default=\"\")  # \"first_suggestion\", \"custom\", \"not_resolved\"\n    custom_solution = db.Column(db.Text, default=\"\")  # What actually worked\n    created_at = db.Column(db.DateTime, default=datetime.now)\n    \n    def to_dict(self) -> Dict:\n        \"\"\"Convert feedback to dictionary\"\"\"\n        return {\n            'id': self.id,\n            'case_id': self.case_id,\n            'effectiveness_score': self.effectiveness_score,\n            'resolution_method': self.resolution_method,\n            'custom_solution': self.custom_solution,\n            'created_at': self.created_at.isoformat() if self.created_at else None\n        }\n\n\nclass SolutionSuggestion:\n    \"\"\"Model for ML-generated solution suggestions\"\"\"\n    \n    def __init__(self, problem_description: str, suggested_solutions: List[str],\n                 confidence: float, system_type: str, similar_cases: Optional[List[Case]] = None):\n        self.problem_description = problem_description\n        self.suggested_solutions = suggested_solutions\n        self.confidence = confidence\n        self.system_type = system_type\n        self.similar_cases = similar_cases or []\n        self.generated_at = datetime.now()\n    \n    def to_dict(self) -> Dict:\n        \"\"\"Convert suggestion to dictionary\"\"\"\n        return {\n            'problem_description': self.problem_description,\n            'suggested_solutions': self.suggested_solutions,\n            'confidence': self.confidence,\n            'system_type': self.system_type,\n            'similar_cases': [case.to_dict() for case in self.similar_cases],\n            'generated_at': self.generated_at.isoformat()\n        }","size_bytes":4613},"pyproject.toml":{"content":"[project]\nname = \"repl-nix-workspace\"\nversion = \"0.1.0\"\ndescription = \"Add your description here\"\nrequires-python = \">=3.11\"\ndependencies = [\n    \"email-validator>=2.2.0\",\n    \"flask>=3.1.1\",\n    \"flask-sqlalchemy>=3.1.1\",\n    \"gunicorn>=23.0.0\",\n    \"numpy>=2.3.2\",\n    \"openai>=1.99.9\",\n    \"openpyxl>=3.1.5\",\n    \"pandas>=2.3.1\",\n    \"psycopg2-binary>=2.9.10\",\n    \"pypdf2>=3.0.1\",\n    \"scikit-learn>=1.7.1\",\n    \"sqlalchemy>=2.0.43\",\n    \"werkzeug>=3.1.3\",\n]\n","size_bytes":463},"replit.md":{"content":"# OS Assistant - AI Technical Support System\n\n## Overview\n\nOS Assistant is a machine learning-powered technical support system designed to help technicians diagnose and resolve work order issues across multiple systems. The application serves as a \"digital mentor\" that analyzes problem descriptions and suggests solutions based on historical cases and proprietary ML models.\n\nThe system focuses on multi-system support (particularly Brazilian hospital management systems like Tasy, SGU, SGU Card, and Autorizador) and uses custom machine learning algorithms to continuously improve its recommendations through user feedback and case history. It operates as a completely internal system with NO external AI dependencies, learning from exported data, reports, or manually entered information using its own ML engine. The system includes workflow for escalating complex cases to Nexdow when internal resolution is not possible.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\nInterface language: Portuguese (complete system translation implemented)\nSpecific systems supported: Tasy, SGU, SGU Card, Autorizador (Brazilian hospital systems)\nEscalation workflow: Include Nexdow escalation options when internal resolution fails\nCase management: Full CRUD operations (Create, Read, Update, Delete) for case management\nUpload functionality: Excel/CSV/PDF import for bulk case addition (structured format only)\nTutorial system: Complete documentation and usage guide integrated\nSecurity requirement: NO external AI connections - system must be 100% internal\nSearch integration: Integrated search within cases panel (no separate search box)\n\n## System Architecture\n\n### Core Architecture Pattern\nThe application follows a traditional Flask MVC architecture with service layer separation:\n\n- **Frontend**: Server-side rendered HTML templates with Bootstrap for responsive UI\n- **Backend**: Flask web framework with modular service-based architecture\n- **Storage**: PostgreSQL database with full persistence and multi-user synchronization\n- **AI Processing**: Custom ML service using scikit-learn for intelligent problem analysis (100% internal)\n\n### Key Architectural Components\n\n**Web Framework**\n- Flask application with blueprint-style route organization\n- Session management with configurable secret keys\n- Template-based rendering using Jinja2\n\n**Service Layer Architecture**\n- `MLService`: Custom machine learning service using scikit-learn for problem analysis, system type detection, and solution generation\n- `CaseService`: Manages case storage, similarity searches using TF-IDF vectorization, and statistics generation\n- Modular design allows easy service replacement or enhancement\n\n**Machine Learning Architecture**\n- Custom ML pipeline using scikit-learn for classification and pattern recognition\n- TF-IDF vectorization for text analysis and similarity matching\n- Support Vector Machine (SVM) and Naive Bayes classifiers for system type detection\n- Rule-based solution generation with pattern matching\n- Incremental learning capabilities that improve with more case data\n\n**Data Models**\n- `Case`: Core entity storing problem descriptions, solutions, system types, and effectiveness feedback\n- `SolutionSuggestion`: Container for AI-generated recommendations with confidence scoring\n- In-memory storage with simple list-based persistence for rapid prototyping\n- Full CRUD operations implemented: Create, Read, Update, Delete cases\n- Real-time ML model retraining after case modifications\n\n**Machine Learning Integration**\n- Scikit-learn TF-IDF vectorization for case similarity matching\n- Cosine similarity calculations for finding related historical cases\n- Continuous learning through user feedback and effectiveness scoring\n\n**Frontend Architecture**\n- Bootstrap-based responsive design with dark theme\n- Feather Icons for consistent iconography\n- Complete Portuguese language interface\n- JavaScript for enhanced UX (form validation, auto-save, search functionality, deletion confirmation)\n- CRUD interface for case management with inline editing and deletion\n\n### Design Patterns and Principles\n\n**Service-Oriented Design**\nThe application separates concerns into distinct services, making it easy to replace components (e.g., switching from in-memory to database storage, or changing AI providers).\n\n**Template-Based UI**\nUses Flask's template inheritance for consistent page layouts and reusable components across all views.\n\n**Stateless Design**\nThe application stores state in Flask's application config, making it easy to transition to external databases when needed.\n\n## External Dependencies\n\n### AI/ML Services (100% Internal)\n- **Scikit-learn**: Complete ML pipeline including TF-IDF vectorization, classification models (SVM, Naive Bayes), and similarity calculations\n- **Custom ML Service**: Proprietary machine learning algorithms for system type detection and solution pattern matching\n- **Model Persistence**: Pickle-based model storage for training persistence and performance optimization\n- **No External AI**: System operates completely offline without OpenAI or any external AI service dependencies\n\n### Frontend Libraries\n- **Bootstrap**: Responsive UI framework with dark theme support\n- **Feather Icons**: Icon library for consistent interface elements\n\n### Python Framework Stack\n- **Flask**: Core web framework for routing and request handling\n- **Jinja2**: Template engine for server-side rendering\n- **NumPy**: Mathematical operations for similarity calculations\n\n### Development Dependencies\n- **Logging**: Built-in Python logging for debugging and error tracking\n- Environment variable management for API keys and configuration\n\nThe system is designed to be easily deployable with Docker and can be hosted on various cloud platforms (AWS, Azure, GCP) or on-premises servers.\n\n## Recent Updates (August 2025)\n\n**Migration to Replit Standard Environment:**\n- Successfully migrated from Replit Agent to standard Replit environment\n- Implemented PostgreSQL database with full persistence and connection pooling\n- Fixed all import/export functionality with robust Excel processing\n- Enhanced file processor to handle Portuguese column names and data validation\n- Improved error handling and database connection stability\n- Created comprehensive system documentation (DOCUMENTACAO_SISTEMA.md)\n- Validated import functionality with 100+ real case data from user upload\n- All security requirements maintained: 100% internal processing, no external AI dependencies\n\n**Database Status:**\n- PostgreSQL database fully operational with 114+ cases stored\n- Enhanced connection pooling with better timeout and pool size management\n- Automatic fallback to in-memory storage if database connectivity issues occur\n- Full CRUD operations implemented and tested\n- Fixed database connection issues that caused worker crashes during import\n\n**Import Functionality:**\n- Fixed \"Internal Server Error\" during file imports\n- Enhanced error handling to prevent application crashes\n- Improved batch processing for large Excel files\n- Added progress logging for import operations\n- Handles Portuguese column names correctly (Problema, Solu√ß√£o, Sistema)\n- Validates data quality and skips invalid entries\n\n**Local Deployment Ready:**\n- Created robust SQLite fallback for local deployment\n- Added run_local.py script for easy local execution\n- Enhanced database connection resilience with retry logic\n- Created complete setup documentation (setup_local.md)\n- System now automatically uses SQLite when PostgreSQL unavailable\n- Ready for deployment on user's local machine with zero external dependencies","size_bytes":7640},"routes.py":{"content":"from flask import render_template, request, jsonify, redirect, url_for, flash\nfrom werkzeug.utils import secure_filename\nfrom app import app\nfrom models import Case, SolutionSuggestion\nfrom ml_service import MLService\nfrom case_service import CaseService\nfrom file_processor import FileProcessor\nimport logging\nimport os\nimport tempfile\n\n# Initialize services\nml_service = MLService()\ncase_service = CaseService()\nfile_processor = FileProcessor()\n\n@app.route('/')\ndef index():\n    \"\"\"Main page with problem input form\"\"\"\n    try:\n        recent_cases = case_service.get_recent_cases(limit=6)\n        return render_template('index.html', recent_cases=recent_cases)\n    except Exception as e:\n        logging.error(f\"Error loading recent cases: {str(e)}\")\n        return render_template('index.html', recent_cases=[])\n\n@app.route('/analyze', methods=['POST'])\ndef analyze_problem():\n    \"\"\"Analyze problem and provide AI suggestions\"\"\"\n    try:\n        problem_description = request.form.get('problem_description', '').strip()\n        \n        if not problem_description:\n            flash('Please enter a problem description.', 'error')\n            return redirect(url_for('index'))\n        \n        # Get ML analysis and suggestions\n        suggestion = ml_service.analyze_problem(problem_description)\n        \n        # Find similar cases\n        similar_cases = case_service.find_similar_cases(problem_description, limit=5)\n        suggestion.similar_cases = similar_cases\n        \n        # Get recent cases for reference\n        recent_cases = case_service.get_recent_cases(limit=6)\n        \n        return render_template('index.html', \n                             suggestion=suggestion, \n                             problem_description=problem_description,\n                             recent_cases=recent_cases)\n        \n    except Exception as e:\n        logging.error(f\"Error analyzing problem: {str(e)}\")\n        flash(f'Error analyzing problem: {str(e)}', 'error')\n        return redirect(url_for('index'))\n\n@app.route('/dashboard')\ndef dashboard():\n    \"\"\"Dashboard showing case statistics and recent cases\"\"\"\n    search_query = request.args.get('search', '').strip()\n    system_filter = request.args.get('system', '')\n    \n    try:\n        stats = case_service.get_statistics()\n        \n        # Get cases based on search/filter or show recent cases\n        if search_query or system_filter:\n            cases = case_service.search_cases(search_query, system_filter)\n        else:\n            cases = case_service.get_recent_cases(limit=50)  # Show more recent cases\n            \n        systems = case_service.get_unique_systems()\n        \n        return render_template('dashboard.html', \n                             stats=stats, \n                             cases=cases,\n                             recent_cases=cases,  # For backward compatibility\n                             search_query=search_query,\n                             system_filter=system_filter,\n                             systems=systems)\n        \n    except Exception as e:\n        logging.error(f\"Error loading dashboard: {str(e)}\")\n        flash(f'Error loading dashboard: {str(e)}', 'error')\n        return render_template('dashboard.html', stats={}, cases=[], recent_cases=[], systems=[])\n\n@app.route('/cases')\ndef list_cases():\n    \"\"\"List all cases with search functionality\"\"\"\n    search_query = request.args.get('search', '').strip()\n    system_filter = request.args.get('system', '')\n    \n    try:\n        if search_query or system_filter:\n            cases = case_service.search_cases(search_query, system_filter)\n        else:\n            cases = case_service.get_all_cases()\n        \n        systems = case_service.get_unique_systems()\n        \n        return render_template('dashboard.html', \n                             cases=cases, \n                             search_query=search_query,\n                             system_filter=system_filter,\n                             systems=systems)\n        \n    except Exception as e:\n        logging.error(f\"Error listing cases: {str(e)}\")\n        flash(f'Error loading cases: {str(e)}', 'error')\n        return render_template('dashboard.html', cases=[], systems=[])\n\n@app.route('/cases/<int:case_id>')\ndef view_case(case_id):\n    \"\"\"Show detailed view of a specific case\"\"\"\n    try:\n        case = case_service.get_case_by_id(case_id)\n        if not case:\n            flash('Case not found.', 'error')\n            return redirect(url_for('dashboard'))\n        \n        return render_template('case_detail.html', case=case)\n        \n    except Exception as e:\n        logging.error(f\"Error loading case {case_id}: {str(e)}\")\n        flash(f'Error loading case: {str(e)}', 'error')\n        return redirect(url_for('dashboard'))\n\n@app.route('/add_case')\ndef add_case_form():\n    \"\"\"Show form to add a new case manually\"\"\"\n    return render_template('add_case.html')\n\n@app.route('/add_case', methods=['POST'])\ndef add_case():\n    \"\"\"Add a new case to the knowledge base\"\"\"\n    try:\n        problem_description = request.form.get('problem_description', '').strip()\n        solution = request.form.get('solution', '').strip()\n        system_type = request.form.get('system_type', 'Desconhecido').strip()\n        custom_system = request.form.get('custom_system', '').strip()\n        \n        # Se selecionou \"Outros\", usar o sistema customizado\n        if system_type == 'Outros' and custom_system:\n            system_type = custom_system\n        \n        if not problem_description or not solution:\n            flash('Descri√ß√£o do problema e solu√ß√£o s√£o obrigat√≥rias.', 'error')\n            return render_template('add_case.html')\n        \n        case = case_service.add_case(problem_description, solution, system_type)\n        \n        # Retrain ML models with new case\n        all_cases = case_service.get_all_cases()\n        if len(all_cases) >= 5:  # Only retrain if we have enough cases\n            ml_service.train_models(all_cases)\n        \n        flash(f'Case #{case.id} added successfully!', 'success')\n        \n        return redirect(url_for('view_case', case_id=case.id))\n        \n    except Exception as e:\n        logging.error(f\"Error adding case: {str(e)}\")\n        flash(f'Error adding case: {str(e)}', 'error')\n        return render_template('add_case.html')\n\n@app.route('/feedback', methods=['POST'])\ndef submit_feedback():\n    \"\"\"Submit feedback on solution effectiveness\"\"\"\n    try:\n        case_id = request.form.get('case_id', type=int)\n        effectiveness = request.form.get('effectiveness', type=int)\n        \n        if not case_id or effectiveness is None:\n            return jsonify({'error': 'Missing required parameters'}), 400\n        \n        if effectiveness < 1 or effectiveness > 5:\n            return jsonify({'error': 'Effectiveness must be between 1 and 5'}), 400\n        \n        success = case_service.add_feedback(case_id, effectiveness)\n        \n        if success:\n            return jsonify({'message': 'Feedback submitted successfully'})\n        else:\n            return jsonify({'error': 'Case not found'}), 404\n            \n    except Exception as e:\n        logging.error(f\"Error submitting feedback: {str(e)}\")\n        return jsonify({'error': str(e)}), 500\n\n@app.route('/api/stats')\ndef api_stats():\n    \"\"\"API endpoint for dashboard statistics\"\"\"\n    try:\n        stats = case_service.get_statistics()\n        return jsonify(stats)\n    except Exception as e:\n        logging.error(f\"Error getting stats: {str(e)}\")\n        return jsonify({'error': str(e)}), 500\n\n@app.route('/api/ml-info')\ndef api_ml_info():\n    \"\"\"API endpoint for ML model information\"\"\"\n    try:\n        ml_info = ml_service.get_model_info()\n        return jsonify(ml_info)\n    except Exception as e:\n        logging.error(f\"Error getting ML info: {str(e)}\")\n        return jsonify({'error': str(e)}), 500\n\n@app.route('/cases/<int:case_id>/edit')\ndef edit_case_form(case_id):\n    \"\"\"Show form to edit an existing case\"\"\"\n    try:\n        case = case_service.get_case_by_id(case_id)\n        if not case:\n            flash('Caso n√£o encontrado.', 'error')\n            return redirect(url_for('dashboard'))\n        \n        return render_template('edit_case.html', case=case)\n        \n    except Exception as e:\n        logging.error(f\"Error loading edit form for case {case_id}: {str(e)}\")\n        flash(f'Erro ao carregar formul√°rio de edi√ß√£o: {str(e)}', 'error')\n        return redirect(url_for('dashboard'))\n\n@app.route('/cases/<int:case_id>/edit', methods=['POST'])\ndef edit_case(case_id):\n    \"\"\"Update an existing case\"\"\"\n    try:\n        problem_description = request.form.get('problem_description', '').strip()\n        solution = request.form.get('solution', '').strip()\n        system_type = request.form.get('system_type', 'Unknown').strip()\n        \n        if not problem_description or not solution:\n            flash('Descri√ß√£o do problema e solu√ß√£o s√£o obrigat√≥rios.', 'error')\n            return redirect(url_for('edit_case_form', case_id=case_id))\n        \n        success = case_service.update_case(case_id, problem_description, solution, system_type)\n        \n        if success:\n            # Retrain ML models with updated cases\n            all_cases = case_service.get_all_cases()\n            if len(all_cases) >= 5:\n                ml_service.train_models(all_cases)\n            \n            flash(f'Caso #{case_id} atualizado com sucesso!', 'success')\n            return redirect(url_for('view_case', case_id=case_id))\n        else:\n            flash('Caso n√£o encontrado.', 'error')\n            return redirect(url_for('dashboard'))\n        \n    except Exception as e:\n        logging.error(f\"Error updating case {case_id}: {str(e)}\")\n        flash(f'Erro ao atualizar caso: {str(e)}', 'error')\n        return redirect(url_for('edit_case_form', case_id=case_id))\n\n@app.route('/cases/<int:case_id>/delete', methods=['POST'])\ndef delete_case(case_id):\n    \"\"\"Delete a case\"\"\"\n    try:\n        success = case_service.delete_case(case_id)\n        \n        if success:\n            # Retrain ML models after deletion\n            all_cases = case_service.get_all_cases()\n            if len(all_cases) >= 5:\n                ml_service.train_models(all_cases)\n            \n            flash(f'Caso #{case_id} exclu√≠do com sucesso!', 'success')\n        else:\n            flash('Caso n√£o encontrado.', 'error')\n        \n        return redirect(url_for('dashboard'))\n        \n    except Exception as e:\n        logging.error(f\"Error deleting case {case_id}: {str(e)}\")\n        flash(f'Erro ao excluir caso: {str(e)}', 'error')\n        return redirect(url_for('dashboard'))\n\n@app.route('/train-models', methods=['POST'])\ndef train_models():\n    \"\"\"Manually trigger ML model training\"\"\"\n    try:\n        all_cases = case_service.get_all_cases()\n        if len(all_cases) < 5:\n            flash('Necess√°rio pelo menos 5 casos para treinar os modelos ML.', 'warning')\n        else:\n            success = ml_service.train_models(all_cases)\n            if success:\n                flash('Modelos ML treinados com sucesso!', 'success')\n            else:\n                flash('Falha ao treinar modelos ML. Verifique os logs para detalhes.', 'error')\n        \n        return redirect(url_for('dashboard'))\n        \n    except Exception as e:\n        logging.error(f\"Error training models: {str(e)}\")\n        flash(f'Erro ao treinar modelos: {str(e)}', 'error')\n        return redirect(url_for('dashboard'))\n\n@app.route('/populate-sample-data', methods=['POST'])\ndef populate_sample_data():\n    \"\"\"Add sample cases for demonstration\"\"\"\n    try:\n        sample_cases = [\n            {\n                'problem': 'Sistema Tasy apresentando erro de conex√£o com banco de dados Oracle. Usu√°rios n√£o conseguem acessar m√≥dulo de prontu√°rio eletr√¥nico. Erro: ORA-12154 TNS could not resolve the connect identifier.',\n                'solution': '1. Verificar conectividade de rede com servidor Oracle\\n2. Validar configura√ß√µes do tnsnames.ora\\n3. Testar conex√£o usando sqlplus\\n4. Reiniciar listener do Oracle se necess√°rio\\n5. Verificar logs do Tasy para detalhes adicionais\\n6. Se problema persistir, abrir chamado para Nexdow',\n                'system': 'Tasy'\n            },\n            {\n                'problem': 'SGU n√£o consegue processar admiss√µes. Erro \"Timeout na comunica√ß√£o com base de dados\" aparece ao tentar registrar novos pacientes. M√≥dulo de gest√£o hospitalar indispon√≠vel.',\n                'solution': '1. Verificar status dos servi√ßos SGU no servidor\\n2. Testar conectividade com banco de dados SGU\\n3. Analisar logs de erro do SGU\\n4. Verificar configura√ß√µes de timeout\\n5. Reiniciar servi√ßos SGU se necess√°rio\\n6. Caso n√£o resolva, escalar para Nexdow',\n                'system': 'SGU'\n            },\n            {\n                'problem': 'SGU Card n√£o imprime carteirinhas de pacientes. Impressora conectada mas recebe dados corrompidos. Erro \"Falha na gera√ß√£o de layout\" no m√≥dulo de cart√µes.',\n                'solution': '1. Verificar driver da impressora de cart√µes\\n2. Testar impress√£o manual de arquivo teste\\n3. Validar template de layout no SGU Card\\n4. Verificar dados do paciente no sistema\\n5. Limpar cache do m√≥dulo Card\\n6. Se necess√°rio, abrir chamado Nexdow para revis√£o do layout',\n                'system': 'SGU Card'\n            },\n            {\n                'problem': 'Autorizador n√£o processa guias de consulta. Fila com 500+ autoriza√ß√µes pendentes. Erro \"Falha na comunica√ß√£o com operadora\" em todas as tentativas.',\n                'solution': '1. Verificar conectividade com APIs das operadoras\\n2. Validar certificados digitais expirados\\n3. Testar manualmente autoriza√ß√£o de uma guia\\n4. Verificar configura√ß√µes de proxy/firewall\\n5. Processar fila manualmente se urgente\\n6. Contatar Nexdow para problemas de integra√ß√£o com operadoras',\n                'system': 'Autorizador'\n            },\n            {\n                'problem': 'Tasy m√≥dulo farm√°cia lento para dispensar medicamentos. Consulta de estoque demora mais de 2 minutos. Pacientes aguardando na fila da farm√°cia.',\n                'solution': '1. Analisar performance de queries no m√≥dulo farm√°cia\\n2. Verificar √≠ndices das tabelas de estoque\\n3. Executar reorganiza√ß√£o de √≠ndices\\n4. Limpar dados antigos da tabela de logs\\n5. Considerar aumento de mem√≥ria do servidor\\n6. Se problema persistir, solicitar an√°lise Nexdow',\n                'system': 'Tasy'\n            },\n            {\n                'problem': 'Rede hospitalar com perda de pacotes na VLAN dos equipamentos m√©dicos. Monitores card√≠acos perdendo conex√£o intermitentemente. Setor UTI afetado.',\n                'solution': '1. Verificar cabos de rede na UTI\\n2. Analisar logs dos switches da VLAN m√©dica\\n3. Testar largura de banda dispon√≠vel\\n4. Verificar configura√ß√µes QoS para tr√°fego m√©dico\\n5. Substituir cabos defeituosos se identificados\\n6. Priorizar tr√°fego cr√≠tico nos switches',\n                'system': 'Network'\n            }\n        ]\n        \n        added_count = 0\n        for sample in sample_cases:\n            case = case_service.add_case(\n                problem_description=sample['problem'],\n                solution=sample['solution'],\n                system_type=sample['system']\n            )\n            added_count += 1\n        \n        # Train ML models with new cases\n        all_cases = case_service.get_all_cases()\n        ml_service.train_models(all_cases)\n        \n        flash(f'{added_count} casos de exemplo adicionados e modelos ML treinados!', 'success')\n        return redirect(url_for('dashboard'))\n        \n    except Exception as e:\n        logging.error(f\"Error adding sample data: {str(e)}\")\n        flash(f'Erro ao adicionar dados de exemplo: {str(e)}', 'error')\n        return redirect(url_for('dashboard'))\n\n@app.route('/upload-cases')\ndef upload_cases_form():\n    \"\"\"Show form to upload cases from files\"\"\"\n    return render_template('upload_cases.html')\n\n@app.route('/upload-cases', methods=['POST'])\ndef upload_cases():\n    \"\"\"Process uploaded file with cases\"\"\"\n    try:\n        if 'file' not in request.files:\n            flash('Nenhum arquivo selecionado.', 'error')\n            return redirect(url_for('upload_cases_form'))\n        \n        file = request.files['file']\n        file_type = request.form.get('file_type')\n        \n        if file.filename == '':\n            flash('Nenhum arquivo selecionado.', 'error')\n            return redirect(url_for('upload_cases_form'))\n        \n        # Import required libraries\n        import pandas as pd\n        import PyPDF2\n        import io\n        from flask import current_app\n        \n        cases_added = 0\n        \n        if file_type == 'excel':\n            # Process Excel/CSV file\n            try:\n                if file.filename and file.filename.endswith('.csv'):\n                    df = pd.read_csv(io.BytesIO(file.read()), encoding='utf-8')\n                else:\n                    df = pd.read_excel(io.BytesIO(file.read()))\n                \n                problem_col = request.form.get('problem_column', 'Problema')\n                solution_col = request.form.get('solution_column', 'Solu√ß√£o')\n                system_col = request.form.get('system_column', 'Sistema')\n                \n                for _, row in df.iterrows():\n                    problem_val = row.get(problem_col)\n                    solution_val = row.get(solution_col)\n                    if (problem_val is not None and pd.notna(problem_val) and \n                        solution_val is not None and pd.notna(solution_val)):\n                        case = case_service.add_case(\n                            problem_description=str(problem_val),\n                            solution=str(solution_val),\n                            system_type=str(row.get(system_col, 'Unknown'))\n                        )\n                        cases_added += 1\n                        \n            except Exception as e:\n                flash(f'Erro ao processar planilha: {str(e)}', 'error')\n                return redirect(url_for('upload_cases_form'))\n        \n        elif file_type == 'pdf':\n            # Process PDF file\n            try:\n                pdf_reader = PyPDF2.PdfReader(io.BytesIO(file.read()))\n                text = \"\"\n                for page in pdf_reader.pages:\n                    text += page.extract_text()\n                \n                # Simple text processing for PDF (basic implementation)\n                lines = text.split('\\n')\n                current_problem = \"\"\n                current_solution = \"\"\n                \n                for line in lines:\n                    line = line.strip()\n                    if not line:\n                        continue\n                    \n                    # Simple heuristics to identify problem/solution pairs\n                    if any(word in line.lower() for word in ['problema:', 'erro:', 'issue:', 'falha:']):\n                        if current_problem and current_solution:\n                            case = case_service.add_case(\n                                problem_description=current_problem,\n                                solution=current_solution,\n                                system_type='Unknown'\n                            )\n                            cases_added += 1\n                        current_problem = line\n                        current_solution = \"\"\n                    elif any(word in line.lower() for word in ['solu√ß√£o:', 'resolu√ß√£o:', 'fix:', 'corre√ß√£o:']):\n                        current_solution = line\n                    elif current_solution and line:\n                        current_solution += \" \" + line\n                \n                # Add last case\n                if current_problem and current_solution:\n                    case = case_service.add_case(\n                        problem_description=current_problem,\n                        solution=current_solution,\n                        system_type='Unknown'\n                    )\n                    cases_added += 1\n                    \n            except Exception as e:\n                flash(f'Erro ao processar PDF: {str(e)}', 'error')\n                return redirect(url_for('upload_cases_form'))\n        \n        if cases_added > 0:\n            # Retrain ML models with new cases\n            all_cases = case_service.get_all_cases()\n            if len(all_cases) >= 5:\n                ml_service.train_models(all_cases)\n            \n            flash(f'{cases_added} casos adicionados com sucesso!', 'success')\n        else:\n            flash('Nenhum caso v√°lido encontrado no arquivo.', 'warning')\n        \n        return redirect(url_for('dashboard'))\n        \n    except Exception as e:\n        logging.error(f\"Error uploading cases: {str(e)}\")\n        flash(f'Erro ao processar arquivo: {str(e)}', 'error')\n        return redirect(url_for('upload_cases_form'))\n\n@app.route('/download-template')\ndef download_template():\n    \"\"\"Download Excel template for case upload\"\"\"\n    try:\n        import pandas as pd\n        import io\n        \n        # Create sample data\n        sample_data = {\n            'Problema': [\n                'Sistema Tasy apresentando lentid√£o extrema',\n                'SGU n√£o consegue processar admiss√µes',\n                'Autorizador rejeitando guias v√°lidas'\n            ],\n            'Solu√ß√£o': [\n                'Reiniciar servi√ßo do Tasy e limpar cache',\n                'Verificar conectividade com banco SGU',\n                'Atualizar certificados digitais'\n            ],\n            'Sistema': ['Tasy', 'SGU', 'Autorizador']\n        }\n        \n        df = pd.DataFrame(sample_data)\n        \n        # Create Excel file in memory\n        output = io.BytesIO()\n        with pd.ExcelWriter(output, engine='openpyxl') as writer:\n            df.to_excel(writer, sheet_name='Casos', index=False)\n        \n        output.seek(0)\n        \n        from flask import send_file\n        return send_file(\n            output,\n            as_attachment=True,\n            download_name='template_casos.xlsx',\n            mimetype='application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'\n        )\n        \n    except Exception as e:\n        logging.error(f\"Error creating template: {str(e)}\")\n        flash(f'Erro ao gerar template: {str(e)}', 'error')\n        return redirect(url_for('upload_cases_form'))\n\n@app.route('/systems')\ndef manage_systems():\n    \"\"\"Manage system types\"\"\"\n    try:\n        # Get system usage statistics\n        all_cases = case_service.get_all_cases()\n        system_stats = {}\n        \n        for case in all_cases:\n            system = case.system_type\n            if system not in system_stats:\n                system_stats[system] = {\n                    'name': system,\n                    'category': 'Healthcare' if system in ['Tasy', 'SGU', 'SGU Card', 'Autorizador'] else 'Other',\n                    'case_count': 0,\n                    'last_used': None\n                }\n            system_stats[system]['case_count'] += 1\n            if not system_stats[system]['last_used'] or case.created_at > system_stats[system]['last_used']:\n                system_stats[system]['last_used'] = case.created_at\n        \n        # Get custom systems from config\n        from flask import current_app\n        custom_systems = current_app.config.get('CUSTOM_SYSTEMS', [])\n        \n        # Merge with usage stats\n        all_systems = []\n        for system_name, stats in system_stats.items():\n            all_systems.append(stats)\n        \n        # Add custom systems that haven't been used\n        for custom in custom_systems:\n            if custom['name'] not in system_stats:\n                custom['case_count'] = 0\n                custom['last_used'] = None\n                all_systems.append(custom)\n        \n        return render_template('manage_systems.html', systems=all_systems)\n        \n    except Exception as e:\n        logging.error(f\"Error loading systems: {str(e)}\")\n        flash(f'Erro ao carregar sistemas: {str(e)}', 'error')\n        return render_template('manage_systems.html', systems=[])\n\n@app.route('/systems/add', methods=['POST'])\ndef add_system():\n    \"\"\"Add new system type\"\"\"\n    try:\n        system_name = request.form.get('system_name', '').strip()\n        system_category = request.form.get('system_category', 'Other')\n        system_description = request.form.get('system_description', '').strip()\n        \n        if not system_name:\n            flash('Nome do sistema √© obrigat√≥rio.', 'error')\n            return redirect(url_for('manage_systems'))\n        \n        # Get current custom systems\n        from flask import current_app\n        custom_systems = current_app.config.get('CUSTOM_SYSTEMS', [])\n        \n        # Check if system already exists\n        if any(s['name'].lower() == system_name.lower() for s in custom_systems):\n            flash('Sistema j√° cadastrado.', 'error')\n            return redirect(url_for('manage_systems'))\n        \n        # Add new system\n        new_system = {\n            'name': system_name,\n            'category': system_category,\n            'description': system_description\n        }\n        custom_systems.append(new_system)\n        current_app.config['CUSTOM_SYSTEMS'] = custom_systems\n        \n        flash(f'Sistema \"{system_name}\" adicionado com sucesso!', 'success')\n        return redirect(url_for('manage_systems'))\n        \n    except Exception as e:\n        logging.error(f\"Error adding system: {str(e)}\")\n        flash(f'Erro ao adicionar sistema: {str(e)}', 'error')\n        return redirect(url_for('manage_systems'))\n\n@app.route('/tutorial')\ndef tutorial():\n    \"\"\"Show tutorial and documentation\"\"\"\n    return render_template('tutorial.html')\n\n@app.route('/cases/<int:case_id>/feedback')\ndef case_feedback_form(case_id):\n    \"\"\"Show feedback form for a case\"\"\"\n    try:\n        case = case_service.get_case_by_id(case_id)\n        if not case:\n            flash('Caso n√£o encontrado.', 'error')\n            return redirect(url_for('dashboard'))\n        \n        return render_template('case_feedback.html', case=case)\n        \n    except Exception as e:\n        logging.error(f\"Error loading feedback form for case {case_id}: {str(e)}\")\n        flash(f'Erro ao carregar formul√°rio de feedback: {str(e)}', 'error')\n        return redirect(url_for('dashboard'))\n\n@app.route('/cases/<int:case_id>/feedback', methods=['POST'])\ndef add_case_feedback(case_id):\n    \"\"\"Add feedback to a case\"\"\"\n    try:\n        effectiveness_score = int(request.form.get('effectiveness_score', 3))\n        resolution_method = request.form.get('resolution_method', '').strip()\n        custom_solution = request.form.get('custom_solution', '').strip()\n        \n        # Validate required fields\n        if not resolution_method:\n            flash('Por favor selecione como o problema foi resolvido.', 'error')\n            return redirect(url_for('case_feedback_form', case_id=case_id))\n        \n        if resolution_method == 'custom_solution' and not custom_solution:\n            flash('Por favor descreva como voc√™ resolveu o problema.', 'error')\n            return redirect(url_for('case_feedback_form', case_id=case_id))\n        \n        # Add feedback to the case\n        success = case_service.add_case_feedback(\n            case_id=case_id,\n            effectiveness_score=effectiveness_score,\n            resolution_method=resolution_method,\n            custom_solution=custom_solution\n        )\n        \n        if success:\n            # Retrain ML models to incorporate feedback learning\n            all_cases = case_service.get_all_cases()\n            if len(all_cases) >= 5:\n                ml_service.train_models(all_cases)\n            \n            if resolution_method == 'first_suggestion':\n                message = '√ìtimo! Feedback registrado. A IA vai aprender com essa solu√ß√£o bem-sucedida.'\n            elif resolution_method == 'custom_solution':\n                message = 'Obrigado! Sua solu√ß√£o personalizada foi registrada e ajudar√° a melhorar as sugest√µes futuras.'\n            else:\n                message = 'Feedback registrado. Vamos trabalhar para melhorar as sugest√µes.'\n            \n            flash(message, 'success')\n            return redirect(url_for('view_case', case_id=case_id))\n        else:\n            flash('Caso n√£o encontrado.', 'error')\n            return redirect(url_for('dashboard'))\n        \n    except ValueError:\n        flash('Avalia√ß√£o de efetividade inv√°lida.', 'error')\n        return redirect(url_for('case_feedback_form', case_id=case_id))\n    except Exception as e:\n        logging.error(f\"Error adding feedback to case {case_id}: {str(e)}\")\n        flash(f'Erro ao adicionar feedback: {str(e)}', 'error')\n        return redirect(url_for('case_feedback_form', case_id=case_id))\n\n@app.route('/import-cases', methods=['POST'])\ndef import_cases():\n    \"\"\"Import cases from file using new AI-powered system\"\"\"\n    try:\n        if 'file' not in request.files:\n            flash('Nenhum arquivo selecionado.', 'error')\n            return redirect(url_for('add_case_form'))\n        \n        file = request.files['file']\n        format_type = request.form.get('format_type', 'structured')\n        \n        if file.filename == '':\n            flash('Nenhum arquivo selecionado.', 'error')\n            return redirect(url_for('upload_cases_form'))\n        \n        # Save file temporarily\n        filename = secure_filename(file.filename or \"upload.txt\")\n        temp_dir = tempfile.gettempdir()\n        temp_path = os.path.join(temp_dir, filename)\n        \n        file.save(temp_path)\n        \n        # Process file using FileProcessor\n        logging.info(f\"Processing file: {temp_path} with format: {format_type}\")\n        cases = file_processor.process_file(temp_path, format_type)\n        logging.info(f\"Processed {len(cases)} cases from file\")\n        \n        cases_added = 0\n        cases_failed = 0\n        \n        for i, case_data in enumerate(cases):\n            try:\n                case = case_service.add_case(\n                    problem_description=case_data['problem_description'],\n                    solution=case_data['solution'],\n                    system_type=case_data['system_type']\n                )\n                cases_added += 1\n                if cases_added % 10 == 0:  # Log progress every 10 cases\n                    logging.info(f\"Added {cases_added} cases so far...\")\n            except Exception as e:\n                cases_failed += 1\n                logging.error(f\"Failed to add case {i+1}: {str(e)}\")\n                # Continue with other cases\n                continue\n        \n        # Clean up temporary file\n        if temp_path and os.path.exists(temp_path):\n            os.unlink(temp_path)\n        \n        if cases_added > 0:\n            # Retrain ML models with new cases\n            try:\n                all_cases = case_service.get_all_cases()\n                if len(all_cases) >= 5:\n                    ml_service.train_models(all_cases)\n                    logging.info(\"ML models retrained successfully\")\n            except Exception as e:\n                logging.warning(f\"Failed to retrain ML models: {str(e)}\")\n            \n            success_msg = f'{cases_added} casos importados com sucesso!'\n            if cases_failed > 0:\n                success_msg += f' ({cases_failed} casos falharam)'\n            flash(success_msg, 'success')\n        else:\n            flash('Nenhum caso v√°lido encontrado no arquivo.', 'warning')\n        \n        return redirect(url_for('dashboard'))\n            \n    except Exception as e:\n        # Clean up temporary file on error\n        if 'temp_path' in locals() and temp_path and os.path.exists(temp_path):\n            try:\n                os.unlink(temp_path)\n            except:\n                pass\n        \n        logging.error(f\"Error importing cases: {str(e)}\")\n        import traceback\n        traceback.print_exc()\n        flash(f'Erro ao importar casos: {str(e)}', 'error')\n        return redirect(url_for('upload_cases_form'))\n","size_bytes":32200},"run_local.py":{"content":"#!/usr/bin/env python3\n\"\"\"\nOS Assistant - Local Development Runner\n\nThis script sets up and runs the OS Assistant application locally with SQLite database.\nPerfect for running on your local machine without external dependencies.\n\"\"\"\n\nimport os\nimport sys\nimport logging\nfrom pathlib import Path\n\n# Set environment variables for local development\nos.environ[\"DATABASE_URL\"] = \"\"  # Forces SQLite usage\nos.environ[\"SESSION_SECRET\"] = \"local-dev-secret-key-change-for-production\"\n\n# Ensure we can import from the current directory\nsys.path.insert(0, str(Path(__file__).parent))\n\n# Set up logging\nlogging.basicConfig(\n    level=logging.INFO,\n    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'\n)\n\nprint(\"=\"*60)\nprint(\"OS ASSISTANT - Sistema de Suporte T√©cnico Inteligente\")\nprint(\"=\"*60)\nprint(\"Configura√ß√£o: SQLite (Banco Local)\")\nprint(\"Porta: 5000\")\nprint(\"URL: http://localhost:5000\")\nprint(\"Pasta do projeto:\", Path(__file__).parent)\nprint(\"=\"*60)\n\ntry:\n    from app import app, db\n    \n    # Create database tables if they don't exist\n    with app.app_context():\n        db.create_all()\n        print(\"‚úÖ Banco de dados SQLite inicializado com sucesso\")\n        print(f\"üìÅ Arquivo do banco: {os.path.join(os.getcwd(), 'os_assistant.db')}\")\n        \n        # Check if we have any existing cases\n        from models import Case\n        case_count = Case.query.count()\n        print(f\"üìä Casos existentes no banco: {case_count}\")\n    \n    print(\"\\nüöÄ Iniciando servidor Flask...\")\n    print(\"üí° Pressione Ctrl+C para parar o servidor\")\n    print(\"=\"*60)\n    \n    # Run the application\n    app.run(\n        host='0.0.0.0',\n        port=5000,\n        debug=True,\n        use_reloader=True\n    )\n\nexcept ImportError as e:\n    print(f\"‚ùå Erro de importa√ß√£o: {e}\")\n    print(\"\\nüì¶ Instale as depend√™ncias necess√°rias:\")\n    print(\"pip install flask flask-sqlalchemy pandas openpyxl scikit-learn\")\n    sys.exit(1)\nexcept Exception as e:\n    print(f\"‚ùå Erro ao iniciar aplica√ß√£o: {e}\")\n    sys.exit(1)","size_bytes":2030},"run_production.py":{"content":"#!/usr/bin/env python3\n\"\"\"\nOS Assistant - Production Server\n\nPara uso com m√∫ltiplos usu√°rios simult√¢neos em rede.\nUse este script quando v√°rias pessoas acessarem ao mesmo tempo.\n\"\"\"\n\nimport os\nimport sys\nimport logging\nfrom pathlib import Path\n\n# Set environment variables for production\nos.environ[\"DATABASE_URL\"] = \"\"  # Forces SQLite usage\nos.environ[\"SESSION_SECRET\"] = \"production-secret-key-change-this\"\nos.environ[\"FLASK_ENV\"] = \"production\"\n\n# Ensure we can import from the current directory\nsys.path.insert(0, str(Path(__file__).parent))\n\n# Set up logging\nlogging.basicConfig(\n    level=logging.INFO,\n    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'\n)\n\nprint(\"=\"*60)\nprint(\"OS ASSISTANT - SERVIDOR PRODU√á√ÉO (Multi-usu√°rio)\")\nprint(\"=\"*60)\nprint(\"Configura√ß√£o: SQLite (Compartilhado)\")\nprint(\"Porta: 5000\")\nprint(\"Acesso em rede: Habilitado\")\nprint(\"Usu√°rios simult√¢neos: Suportado\")\nprint(\"=\"*60)\n\ntry:\n    from app import app, db\n    \n    # Create database tables if they don't exist\n    with app.app_context():\n        db.create_all()\n        print(\"‚úÖ Banco de dados SQLite inicializado\")\n        print(f\"üìÅ Arquivo do banco: {os.path.join(os.getcwd(), 'os_assistant.db')}\")\n        \n        # Check if we have any existing cases\n        from models import Case\n        case_count = Case.query.count()\n        print(f\"üìä Casos existentes: {case_count}\")\n    \n    print(\"\\nüöÄ Iniciando servidor de produ√ß√£o...\")\n    print(\"üåê Acesso em rede habilitado para m√∫ltiplos usu√°rios\")\n    print(\"üí° Pressione Ctrl+C para parar\")\n    print(\"=\"*60)\n    \n    # Run with Gunicorn-like settings for better performance\n    app.run(\n        host='0.0.0.0',\n        port=5000,\n        debug=False,  # Disabled for production\n        threaded=True,  # Enable threading for multiple users\n        use_reloader=False\n    )\n\nexcept ImportError as e:\n    print(f\"‚ùå Erro de importa√ß√£o: {e}\")\n    print(\"\\nüì¶ Instale as depend√™ncias:\")\n    print(\"pip install -r requirements_local.txt\")\n    sys.exit(1)\nexcept Exception as e:\n    print(f\"‚ùå Erro ao iniciar: {e}\")\n    sys.exit(1)","size_bytes":2119},"setup_local.md":{"content":"# OS Assistant - Instala√ß√£o e Configura√ß√£o Local\n\n## Como Rodar na Sua M√°quina\n\n### Pr√©-requisitos\n- Python 3.8 ou superior\n- pip (gerenciador de pacotes Python)\n\n### Instala√ß√£o R√°pida\n\n1. **Baixe todos os arquivos do projeto** para uma pasta no seu computador\n\n2. **Abra o terminal/prompt na pasta do projeto**\n\n3. **Instale as depend√™ncias:**\n```bash\npip install flask flask-sqlalchemy pandas openpyxl scikit-learn gunicorn werkzeug numpy PyPDF2 email-validator psycopg2-binary\n```\n\n4. **Execute o aplicativo:**\n```bash\npython run_local.py\n```\n\n5. **Acesse no navegador:**\n```\nhttp://localhost:5000\n```\n\n### Estrutura de Arquivos Necess√°rios\n\nCertifique-se de ter todos estes arquivos na pasta:\n\n```\nOS-Assistant/\n‚îú‚îÄ‚îÄ run_local.py           # ‚Üê Script principal para executar\n‚îú‚îÄ‚îÄ app.py                 # Configura√ß√£o do Flask\n‚îú‚îÄ‚îÄ main.py                # Ponto de entrada alternativo\n‚îú‚îÄ‚îÄ models.py              # Modelos do banco de dados\n‚îú‚îÄ‚îÄ routes.py              # Rotas da aplica√ß√£o\n‚îú‚îÄ‚îÄ case_service.py        # Servi√ßo de gerenciamento de casos\n‚îú‚îÄ‚îÄ ml_service.py          # Servi√ßo de machine learning\n‚îú‚îÄ‚îÄ file_processor.py      # Processamento de arquivos\n‚îú‚îÄ‚îÄ static/\n‚îÇ   ‚îú‚îÄ‚îÄ style.css          # Estilos CSS\n‚îÇ   ‚îî‚îÄ‚îÄ script.js          # JavaScript\n‚îú‚îÄ‚îÄ templates/             # Templates HTML\n‚îÇ   ‚îú‚îÄ‚îÄ base.html\n‚îÇ   ‚îú‚îÄ‚îÄ index.html\n‚îÇ   ‚îú‚îÄ‚îÄ dashboard.html\n‚îÇ   ‚îú‚îÄ‚îÄ add_case.html\n‚îÇ   ‚îú‚îÄ‚îÄ upload_cases.html\n‚îÇ   ‚îî‚îÄ‚îÄ ... (outros templates)\n‚îî‚îÄ‚îÄ ml_models/             # Modelos de ML (criados automaticamente)\n```\n\n### Banco de Dados Local\n\n- **Tipo:** SQLite (arquivo local)\n- **Localiza√ß√£o:** `os_assistant.db` na pasta do projeto\n- **Backup:** Simplesmente copie o arquivo `os_assistant.db`\n- **Reset:** Delete o arquivo para come√ßar do zero\n\n### Importa√ß√£o de Dados\n\n1. Acesse \"Upload de Casos\" no menu\n2. Selecione seu arquivo Excel com colunas:\n   - **Problema**: Descri√ß√£o do problema\n   - **Solu√ß√£o**: Solu√ß√£o aplicada\n   - **Sistema**: Tipo de sistema (opcional)\n3. Clique em \"Importar\"\n\n### Funcionalidades Principais\n\n- ‚úÖ **An√°lise de Problemas**: IA analisa e sugere solu√ß√µes\n- ‚úÖ **Importa√ß√£o Excel**: Carregue casos em lote\n- ‚úÖ **Dashboard**: Estat√≠sticas e casos recentes\n- ‚úÖ **CRUD Completo**: Criar, editar, deletar casos\n- ‚úÖ **Busca Inteligente**: Encontre casos similares\n- ‚úÖ **100% Offline**: Sem depend√™ncias externas\n\n### Solu√ß√£o de Problemas\n\n#### Erro: \"ModuleNotFoundError\"\n```bash\npip install --upgrade pip\npip install flask flask-sqlalchemy pandas openpyxl scikit-learn\n```\n\n#### Erro: \"Port already in use\"\n```bash\n# Use outra porta editando run_local.py, linha:\napp.run(port=5001)  # Mude de 5000 para 5001\n```\n\n#### Erro: \"Permission denied\" no banco\n```bash\n# Verifique permiss√µes da pasta\nchmod 755 .\n```\n\n#### Importa√ß√£o falha\n- Verifique se as colunas est√£o nomeadas: \"Problema\", \"Solu√ß√£o\", \"Sistema\"\n- Arquivo deve ser .xlsx ou .csv\n- M√°ximo 5MB recomendado\n\n### Performance\n\n- **Casos suportados:** At√© 10.000 casos\n- **Importa√ß√£o:** At√© 1.000 casos por vez\n- **Mem√≥ria:** ~100MB RAM\n- **Espa√ßo:** ~50MB disco\n\n### Backup e Migra√ß√£o\n\n#### Backup Completo\n```bash\n# Copie estes arquivos:\ncp os_assistant.db backup/\ncp -r ml_models/ backup/\n```\n\n#### Restaurar Backup\n```bash\ncp backup/os_assistant.db .\ncp -r backup/ml_models/ .\n```\n\n### Customiza√ß√£o\n\n#### Mudar Porta\nEdite `run_local.py`, linha 57:\n```python\napp.run(port=8080)  # Sua porta preferida\n```\n\n#### Ativar Debug SQL\nEdite `app.py`, linha 49:\n```python\n\"echo\": True  # Mostra queries SQL no console\n```\n\n#### Adicionar Sistemas\nAcesse \"Gerenciar Sistemas\" no menu da aplica√ß√£o\n\n### Suporte\n\n- **Documenta√ß√£o completa:** `DOCUMENTACAO_SISTEMA.md`\n- **Logs de erro:** Aparecem no terminal onde executou\n- **Banco de dados:** SQLite Browser para visualizar dados","size_bytes":3958},"static/script.js":{"content":"// OS Assistant - Custom JavaScript functionality\n\n// Global variables\nlet searchTimeout = null;\nlet currentFeedbackCaseId = null;\n\n// Initialize when DOM is loaded\ndocument.addEventListener('DOMContentLoaded', function() {\n    initializeComponents();\n    setupEventListeners();\n    loadUserPreferences();\n});\n\n// Initialize various components\nfunction initializeComponents() {\n    // Initialize tooltips if Bootstrap tooltips are available\n    if (typeof bootstrap !== 'undefined' && bootstrap.Tooltip) {\n        const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle=\"tooltip\"]'));\n        tooltipTriggerList.map(function (tooltipTriggerEl) {\n            return new bootstrap.Tooltip(tooltipTriggerEl);\n        });\n    }\n    \n    // Auto-resize textareas\n    autoResizeTextareas();\n    \n    // Initialize search functionality\n    setupSearchFunctionality();\n}\n\n// Setup event listeners\nfunction setupEventListeners() {\n    // Form validation\n    const forms = document.querySelectorAll('form');\n    forms.forEach(form => {\n        form.addEventListener('submit', handleFormSubmission);\n    });\n    \n    // Keyboard shortcuts\n    document.addEventListener('keydown', handleKeyboardShortcuts);\n    \n    // Auto-save functionality for forms\n    setupAutoSave();\n    \n    // Handle back button navigation\n    window.addEventListener('popstate', handleBackNavigation);\n}\n\n// Handle form submissions with loading states\nfunction handleFormSubmission(event) {\n    const form = event.target;\n    const submitButton = form.querySelector('button[type=\"submit\"]');\n    \n    if (submitButton) {\n        // Show loading state\n        const originalText = submitButton.innerHTML;\n        submitButton.innerHTML = '<i data-feather=\"loader\" class=\"me-1\"></i>Processing...';\n        submitButton.disabled = true;\n        \n        // Re-initialize feather icons\n        if (typeof feather !== 'undefined') {\n            feather.replace();\n        }\n        \n        // Reset button after 10 seconds (fallback)\n        setTimeout(() => {\n            submitButton.innerHTML = originalText;\n            submitButton.disabled = false;\n            if (typeof feather !== 'undefined') {\n                feather.replace();\n            }\n        }, 10000);\n    }\n}\n\n// Keyboard shortcuts\nfunction handleKeyboardShortcuts(event) {\n    // Ctrl+Enter to submit forms\n    if (event.ctrlKey && event.key === 'Enter') {\n        const activeForm = document.querySelector('form:focus-within');\n        if (activeForm) {\n            activeForm.submit();\n        }\n    }\n    \n    // Escape to close modals\n    if (event.key === 'Escape') {\n        const openModal = document.querySelector('.modal.show');\n        if (openModal && typeof bootstrap !== 'undefined') {\n            const modal = bootstrap.Modal.getInstance(openModal);\n            if (modal) {\n                modal.hide();\n            }\n        }\n    }\n}\n\n// Auto-resize textareas\nfunction autoResizeTextareas() {\n    const textareas = document.querySelectorAll('textarea');\n    textareas.forEach(textarea => {\n        textarea.addEventListener('input', function() {\n            this.style.height = 'auto';\n            this.style.height = Math.min(this.scrollHeight, 400) + 'px';\n        });\n        \n        // Initial resize\n        textarea.dispatchEvent(new Event('input'));\n    });\n}\n\n// Setup search functionality\nfunction setupSearchFunctionality() {\n    const searchInputs = document.querySelectorAll('input[name=\"search\"]');\n    searchInputs.forEach(input => {\n        input.addEventListener('input', function() {\n            // Debounce search\n            clearTimeout(searchTimeout);\n            searchTimeout = setTimeout(() => {\n                performInstantSearch(this.value);\n            }, 300);\n        });\n    });\n}\n\n// Perform instant search (for future enhancement)\nfunction performInstantSearch(query) {\n    // This could be enhanced to perform real-time search\n    console.log('Searching for:', query);\n}\n\n// Auto-save functionality\nfunction setupAutoSave() {\n    const autoSaveInputs = document.querySelectorAll('textarea[name=\"problem_description\"], textarea[name=\"solution\"]');\n    autoSaveInputs.forEach(input => {\n        input.addEventListener('input', debounce(saveFormData, 2000));\n    });\n}\n\n// Debounce function\nfunction debounce(func, wait) {\n    let timeout;\n    return function executedFunction(...args) {\n        const later = () => {\n            clearTimeout(timeout);\n            func(...args);\n        };\n        clearTimeout(timeout);\n        timeout = setTimeout(later, wait);\n    };\n}\n\n// Save form data to localStorage\nfunction saveFormData() {\n    const forms = document.querySelectorAll('form');\n    forms.forEach(form => {\n        const formData = new FormData(form);\n        const data = {};\n        \n        for (let [key, value] of formData.entries()) {\n            data[key] = value;\n        }\n        \n        if (Object.keys(data).length > 0) {\n            localStorage.setItem(`form_${form.action}`, JSON.stringify(data));\n        }\n    });\n}\n\n// Load form data from localStorage\nfunction loadFormData() {\n    const forms = document.querySelectorAll('form');\n    forms.forEach(form => {\n        const saved = localStorage.getItem(`form_${form.action}`);\n        if (saved) {\n            try {\n                const data = JSON.parse(saved);\n                Object.keys(data).forEach(key => {\n                    const input = form.querySelector(`[name=\"${key}\"]`);\n                    if (input && input.type !== 'file') {\n                        input.value = data[key];\n                    }\n                });\n            } catch (e) {\n                console.error('Error loading saved form data:', e);\n            }\n        }\n    });\n}\n\n// Handle back button navigation\nfunction handleBackNavigation(event) {\n    // Clean up any unsaved data warnings if needed\n    console.log('Navigating back');\n}\n\n// Load user preferences\nfunction loadUserPreferences() {\n    const prefs = localStorage.getItem('userPreferences');\n    if (prefs) {\n        try {\n            const preferences = JSON.parse(prefs);\n            applyPreferences(preferences);\n        } catch (e) {\n            console.error('Error loading user preferences:', e);\n        }\n    }\n}\n\n// Apply user preferences\nfunction applyPreferences(preferences) {\n    // Apply theme preferences, font size, etc.\n    if (preferences.theme) {\n        document.documentElement.setAttribute('data-bs-theme', preferences.theme);\n    }\n}\n\n// Utility functions\nconst Utils = {\n    // Show notification toast\n    showToast: function(message, type = 'info', duration = 5000) {\n        const toastId = 'toast-' + Date.now();\n        const toastHtml = `\n            <div id=\"${toastId}\" class=\"toast align-items-center text-bg-${type} border-0\" role=\"alert\" \n                 style=\"position: fixed; top: 20px; right: 20px; z-index: 1050;\">\n                <div class=\"d-flex\">\n                    <div class=\"toast-body\">${message}</div>\n                    <button type=\"button\" class=\"btn-close btn-close-white me-2 m-auto\" data-bs-dismiss=\"toast\"></button>\n                </div>\n            </div>\n        `;\n        \n        document.body.insertAdjacentHTML('beforeend', toastHtml);\n        \n        if (typeof bootstrap !== 'undefined') {\n            const toastElement = document.getElementById(toastId);\n            const toast = new bootstrap.Toast(toastElement, { delay: duration });\n            toast.show();\n            \n            // Remove toast element after it's hidden\n            toastElement.addEventListener('hidden.bs.toast', function() {\n                toastElement.remove();\n            });\n        }\n    },\n    \n    // Copy text to clipboard\n    copyToClipboard: function(text) {\n        if (navigator.clipboard && window.isSecureContext) {\n            return navigator.clipboard.writeText(text).then(() => {\n                this.showToast('Copied to clipboard!', 'success');\n            }).catch(err => {\n                console.error('Failed to copy:', err);\n                this.fallbackCopyTextToClipboard(text);\n            });\n        } else {\n            this.fallbackCopyTextToClipboard(text);\n        }\n    },\n    \n    // Fallback copy method\n    fallbackCopyTextToClipboard: function(text) {\n        const textArea = document.createElement('textarea');\n        textArea.value = text;\n        textArea.style.top = '0';\n        textArea.style.left = '0';\n        textArea.style.position = 'fixed';\n        textArea.style.opacity = '0';\n        \n        document.body.appendChild(textArea);\n        textArea.focus();\n        textArea.select();\n        \n        try {\n            const successful = document.execCommand('copy');\n            if (successful) {\n                this.showToast('Copied to clipboard!', 'success');\n            } else {\n                this.showToast('Failed to copy to clipboard', 'danger');\n            }\n        } catch (err) {\n            console.error('Fallback copy failed:', err);\n            this.showToast('Failed to copy to clipboard', 'danger');\n        }\n        \n        document.body.removeChild(textArea);\n    },\n    \n    // Format date for display\n    formatDate: function(dateString) {\n        const date = new Date(dateString);\n        const now = new Date();\n        const diffTime = Math.abs(now - date);\n        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n        \n        if (diffDays === 1) {\n            return 'Yesterday';\n        } else if (diffDays < 7) {\n            return `${diffDays} days ago`;\n        } else {\n            return date.toLocaleDateString();\n        }\n    },\n    \n    // Validate form fields\n    validateForm: function(form) {\n        const errors = [];\n        const requiredFields = form.querySelectorAll('[required]');\n        \n        requiredFields.forEach(field => {\n            if (!field.value.trim()) {\n                errors.push(`${field.labels[0]?.textContent || field.name} is required`);\n                field.classList.add('is-invalid');\n            } else {\n                field.classList.remove('is-invalid');\n            }\n        });\n        \n        return {\n            isValid: errors.length === 0,\n            errors: errors\n        };\n    },\n    \n    // Highlight search terms\n    highlightText: function(text, searchTerm) {\n        if (!searchTerm) return text;\n        \n        const regex = new RegExp(`(${searchTerm})`, 'gi');\n        return text.replace(regex, '<span class=\"search-highlight\">$1</span>');\n    }\n};\n\n// Export utility functions to global scope\nwindow.OSAssistant = {\n    Utils: Utils,\n    showToast: Utils.showToast,\n    copyToClipboard: Utils.copyToClipboard\n};\n\n// Performance monitoring\nwindow.addEventListener('load', function() {\n    // Log performance metrics\n    if (window.performance) {\n        const loadTime = window.performance.timing.loadEventEnd - window.performance.timing.navigationStart;\n        console.log(`Page loaded in ${loadTime}ms`);\n    }\n});\n\n// Error handling\nwindow.addEventListener('error', function(event) {\n    console.error('JavaScript error:', event.error);\n    // Could send error reports to server in production\n});\n\n// Handle offline/online status\nwindow.addEventListener('offline', function() {\n    Utils.showToast('You are now offline. Some features may not work.', 'warning');\n});\n\nwindow.addEventListener('online', function() {\n    Utils.showToast('You are back online!', 'success');\n});\n","size_bytes":11458},"static/style.css":{"content":"/* Custom styles for OS Assistant */\n\n/* Override some Bootstrap defaults for better technical interface */\n:root {\n    --custom-code-bg: #1a1a1a;\n    --custom-border-radius: 8px;\n}\n\n/* Code and pre styling */\npre {\n    background-color: var(--custom-code-bg) !important;\n    border: 1px solid var(--bs-border-color);\n    border-radius: var(--custom-border-radius);\n    color: var(--bs-body-color);\n    font-family: 'Consolas', 'Monaco', 'Courier New', monospace;\n    font-size: 0.875rem;\n    line-height: 1.5;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n}\n\n/* Card styling improvements */\n.card {\n    border-radius: var(--custom-border-radius);\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n    margin-bottom: 1rem;\n}\n\n.card-header {\n    background-color: var(--bs-dark);\n    border-bottom: 1px solid var(--bs-border-color);\n    border-radius: var(--custom-border-radius) var(--custom-border-radius) 0 0 !important;\n}\n\n/* Form improvements */\n.form-control:focus {\n    border-color: var(--bs-primary);\n    box-shadow: 0 0 0 0.2rem rgba(var(--bs-primary-rgb), 0.25);\n}\n\ntextarea.form-control {\n    font-family: 'Consolas', 'Monaco', 'Courier New', monospace;\n    font-size: 0.9rem;\n    line-height: 1.5;\n}\n\n/* Button improvements */\n.btn {\n    border-radius: var(--custom-border-radius);\n    font-weight: 500;\n}\n\n.btn-group .btn {\n    border-radius: 0;\n}\n\n.btn-group .btn:first-child {\n    border-radius: var(--custom-border-radius) 0 0 var(--custom-border-radius);\n}\n\n.btn-group .btn:last-child {\n    border-radius: 0 var(--custom-border-radius) var(--custom-border-radius) 0;\n}\n\n/* Table improvements */\n.table-responsive {\n    border-radius: var(--custom-border-radius);\n}\n\n.table th {\n    border-top: none;\n    font-weight: 600;\n    font-size: 0.875rem;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n}\n\n.table td {\n    vertical-align: middle;\n    border-color: var(--bs-border-color);\n}\n\n/* Progress bar styling */\n.progress {\n    border-radius: var(--custom-border-radius);\n    background-color: var(--bs-secondary-bg);\n}\n\n.progress-bar {\n    border-radius: var(--custom-border-radius);\n}\n\n/* Badge improvements */\n.badge {\n    border-radius: var(--custom-border-radius);\n    font-weight: 500;\n    font-size: 0.75rem;\n}\n\n/* Alert styling */\n.alert {\n    border-radius: var(--custom-border-radius);\n    border: none;\n}\n\n/* Navigation improvements */\n.navbar-brand {\n    font-weight: 700;\n    font-size: 1.25rem;\n}\n\n.nav-link {\n    font-weight: 500;\n}\n\n/* Footer styling */\nfooter {\n    margin-top: auto;\n}\n\n/* Modal improvements */\n.modal-content {\n    border-radius: var(--custom-border-radius);\n    border: none;\n}\n\n.modal-header {\n    border-bottom: 1px solid var(--bs-border-color);\n}\n\n/* Responsive improvements */\n@media (max-width: 768px) {\n    .container {\n        padding-left: 15px;\n        padding-right: 15px;\n    }\n    \n    .card-body {\n        padding: 1rem;\n    }\n    \n    .btn {\n        font-size: 0.875rem;\n    }\n    \n    .table-responsive {\n        font-size: 0.875rem;\n    }\n}\n\n/* Utility classes */\n.text-wrap {\n    white-space: pre-wrap;\n    word-wrap: break-word;\n}\n\n.cursor-pointer {\n    cursor: pointer;\n}\n\n/* Loading states */\n.loading {\n    opacity: 0.6;\n    pointer-events: none;\n}\n\n.loading::after {\n    content: \"\";\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    margin: -12px 0 0 -12px;\n    width: 24px;\n    height: 24px;\n    border: 2px solid var(--bs-primary);\n    border-radius: 50%;\n    border-top-color: transparent;\n    animation: spin 1s ease-in-out infinite;\n}\n\n@keyframes spin {\n    to {\n        transform: rotate(360deg);\n    }\n}\n\n/* Toast positioning */\n.toast-container {\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    z-index: 1050;\n}\n\n/* Highlight search results */\n.search-highlight {\n    background-color: rgba(var(--bs-warning-rgb), 0.3);\n    padding: 2px 4px;\n    border-radius: 3px;\n}\n\n/* Custom scrollbar for webkit browsers */\n::-webkit-scrollbar {\n    width: 8px;\n}\n\n::-webkit-scrollbar-track {\n    background: var(--bs-dark);\n}\n\n::-webkit-scrollbar-thumb {\n    background: var(--bs-secondary);\n    border-radius: 4px;\n}\n\n::-webkit-scrollbar-thumb:hover {\n    background: var(--bs-light);\n}\n\n/* Print styles */\n@media print {\n    .navbar,\n    .btn,\n    footer {\n        display: none !important;\n    }\n    \n    .card {\n        border: 1px solid #000 !important;\n        box-shadow: none !important;\n    }\n    \n    .card-body {\n        padding: 1rem !important;\n    }\n    \n    pre {\n        background-color: #f8f9fa !important;\n        border: 1px solid #000 !important;\n        color: #000 !important;\n    }\n}\n","size_bytes":4609}}}